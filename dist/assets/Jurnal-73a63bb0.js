import{S as k}from"./Sidebar-f810e528.js";import{N as y,F as b}from"./Footer-efae84de.js";import{a as c,S as w}from"./sweetalert2.all-1e3fb24f.js";import{P as g,D as v}from"./jquery.dataTables-11f5c627.js";import{r as m,b as n,f as p,i as u,n as M,g as a,l as _,c as S,z as B,A,F as x,B as C,C as r}from"./index-6973fbdc.js";const D={id:"wrapper"},j={id:"content-wrapper",class:"d-flex flex-column"},T={id:"content"},J={class:"container-fluid mt-4"},F=a("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"},"List Jurnal",-1),N={class:"row"},z=a("div",{class:"col-1"},null,-1),I={class:"col-10"},q={class:"table-responsive mt-5"},R={key:0,class:"text-center"},U=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col"},"Pengirim"),a("th",{scope:"col"},"Jumlah"),a("th",{scope:"col"},"Tanggal"),a("th",{scope:"col"},"Catatan"),a("th",{scope:"col"},"Penerima")])],-1),P=a("div",{class:"col-1"},null,-1);g.use(v);const L={data(){return{jurnals:[],formMapel:{nama_mapel:""},formUpdateMapel:{nama_mapel:""},ready:!1,mapel_id:""}},methods:{createMapel(){this.ready=!1;const t=new FormData;t.append("nama_mapel",this.formMapel.nama_mapel),c.post("https://backend.keuanganfpti.com/api/create-mapel",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil buat","success"),this.fetchDataJurnal()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal buat","error"),console.error(e),this.ready=!0})},updateMapel(){this.ready=!1;const t=new FormData;t.append("nama_mapel",this.formUpdateMapel.nama_mapel),c.post(`https://backend.keuanganfpti.com/api/update-mapel/${this.mapel_id}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil diupdate","success"),this.fetchDataJurnal()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal diupdate","error"),console.error(e),this.ready=!0})},deleteMapel(t){this.ready=!1,c.delete(`https://backend.keuanganfpti.com/api/delete-mapel/${t}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.showAlert("Request Success","Matapelajaran berhasil dihapus","success"),this.fetchDataJurnal()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal dihapus","error"),console.error(e),this.ready=!0})},async fetchDataJurnal(){try{const t=await c.get("https://backend.keuanganfpti.com/api/data-jurnal",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.jurnals=t.data.data,this.ready=!0}catch(t){this.ready=!0,console.error(t)}},showAlert(t,e,s){this.$swal({title:t,text:e,icon:s}).then(()=>{$("#addMapel").modal("hide"),$("#editMapel").modal("hide")})},konfirmasi(t,e){w.fire({title:`Apakah Anda yakin ingin menghapus matapelajaran ${e}?`,text:"Anda akan keluar dari akun ini.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&this.deleteMapel(t)})},setMapelId(t,e){this.mapel_id=t,this.formUpdateMapel.nama_mapel=e}},created(){const t=sessionStorage.getItem("token");if(t)try{const[e,s]=t.split("."),h=JSON.parse(atob(e)),l=atob(s),i=JSON.parse(atob(t.split(".")[1])),o=i.exp,d=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",d.toUTCString()),new Date>d?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const f=i.level;this.user_id=i.id,console.log("ini idddd:",this.user_id),f!=="0"?this.$router.push("/unauthorized"):(!h||!l)&&this.$router.push("/"),this.fetchDataJurnal()}catch(e){console.error("Error decoding token:",e),this.$router.push("/")}else this.$router.push("/")}},W=Object.assign(L,{__name:"Jurnal",setup(t){const e=m(!1),s=m(""),h=()=>{e.value=!e.value,s.value=e.value?"toggle-sidebar":""};return(l,i)=>(n(),p("div",D,[u(k,{class:M(s.value)},null,8,["class"]),a("div",j,[a("div",T,[u(y,{onToggleSidebar:h}),a("div",J,[F,a("div",N,[z,a("div",I,[a("div",q,[l.ready?_("",!0):(n(),p("p",R,"Loading...")),l.ready?(n(),S(A(g),{key:1,class:"display table table-striped"},{default:B(()=>[U,a("tbody",null,[(n(!0),p(x,null,C(l.jurnals,(o,d)=>(n(),p("tr",{key:o.id},[a("td",null,r(d+1),1),a("td",null,r(o.nama_pengirim),1),a("td",null,r(o.jumlah_transaksi),1),a("td",null,r(o.tgl_transaksi),1),a("td",null,r(o.deskripsi),1),a("td",null,r(o.nama_penerima),1)]))),128))])]),_:1})):_("",!0)])]),P])])]),u(b)])]))}});export{W as default};
