import{r as b,b as r,f as i,g as e,i as _,n as T,l as v,c as w,z as U,A as C,j as d,v as c,D as P,F as g,B as f,y as D,C as u}from"./index-c01b12d4.js";import{S}from"./Sidebar-0d63748e.js";import"./TimeVote-ea42eaf2.js";import{N as B,F as A}from"./Footer-8f41188f.js";import{a as p,S as j}from"./sweetalert2.all-1e3fb24f.js";import{P as y,D as V}from"./jquery.dataTables-31a7655e.js";const N={id:"wrapper"},F={id:"content-wrapper",class:"d-flex flex-column"},I={id:"content"},M={class:"container-fluid mt-4"},z=e("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," List Pengeluaran ",-1),R={class:"row"},q=e("div",{class:"col-1"},null,-1),L={class:"col-10"},K=D('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addPengeluaran"><i class="bi bi-plus-circle-fill"></i> Pengeluaran </button></div><div class="col-6"></div></div>',1),J={class:"table-responsive"},E={key:0,class:"text-center"},O=e("thead",null,[e("tr",null,[e("th",{scope:"col",style:{width:"50px"}},"No"),e("th",{scope:"col"},"Aksi"),e("th",{scope:"col"},"Nominal"),e("th",{scope:"col"},"Keterangan"),e("th",{scope:"col"},"Tanggal Masuk"),e("th",{scope:"col"},"Penerima")])],-1),H={class:"row"},W={class:"col-6"},G=["onClick"],Q=e("i",{class:"bi bi-pencil-square"},null,-1),X=[Q],Y={class:"col-6"},Z=["onClick"],x=e("i",{class:"bi bi-trash3"},null,-1),ee=[x],ae=e("div",{class:"col-1"},null,-1),se={class:"modal fade",id:"addPengeluaran",tabindex:"-1",role:"dialog","aria-labelledby":"addPengeluaranLabel","aria-hidden":"true"},te={class:"modal-dialog",role:"document"},ne={class:"modal-content"},oe=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addPengeluaranLabel"}," Masukkan Pengeluaran "),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),le={class:"modal-body"},re={class:"mb-3"},ie=e("label",{for:"ketua",class:"form-label"},"Jumlah Pengeluaran",-1),de={class:"mb-3"},ue=e("label",{for:"ketua",class:"form-label"},"Tanggal Transaksi",-1),ce={class:"mb-3"},me=e("label",{for:"mission",class:"form-label"},"Penerima",-1),pe=e("option",{value:"",disabled:"",selected:""},"Pilih Penerima",-1),he=["value"],ge={class:"mb-3"},ke=e("label",{for:"keterangan",class:"form-label"},"Keterangan",-1),_e={class:"modal-footer"},fe=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),be={class:"modal fade",id:"editTransaksi",tabindex:"-1",role:"dialog","aria-labelledby":"editTransaksiLabel","aria-hidden":"true"},ve={class:"modal-dialog",role:"document"},Pe={class:"modal-content"},ye=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"editTransaksiLabel"},"Edit Pengeluaran"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),Te={class:"modal-body"},we={class:"mb-3"},Ue=e("label",{for:"ketua",class:"form-label"},"Jumlah Pengeluaran",-1),Ce={class:"mb-3"},De=e("label",{for:"ketua",class:"form-label"},"Tanggal Transaksi",-1),Se={class:"mb-3"},Be=e("label",{for:"mission",class:"form-label"},"Penerima",-1),Ae=e("option",{value:"",disabled:"",selected:""},"Pilih Penerima",-1),je=["value"],Ve={class:"mb-3"},$e=e("label",{for:"keterangan",class:"form-label"},"Keterangan",-1),Ne={class:"modal-footer"},Fe=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(V);const Ie={data(){return{pengeluaran:[],penerimas:[],formPengeluaran:{jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",id_penerima:""},formUpdateTransaksi:{jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",id_penerima:"",id:""},ready:!1,selectedPenerima:"",user_id:""}},methods:{setDataUpdate(s,n,l,m,t){this.formUpdateTransaksi.jumlah_transaksi=s,this.formUpdateTransaksi.deskripsi=n,this.formUpdateTransaksi.tgl_transaksi=l,this.formUpdateTransaksi.id=t,this.selectedPenerima=m},createMapel(){this.ready=!1;const s=new FormData;s.append("jumlah_transaksi",this.formPengeluaran.jumlah_transaksi),s.append("deskripsi",this.formPengeluaran.deskripsi),s.append("tgl_transaksi",this.formPengeluaran.tgl_transaksi),s.append("id_pengirim",this.user_id),s.append("id_penerima",this.selectedPenerima),p.post("https://backend.keuanganfpti.com/api/create-transaksi",s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.formPengeluaran={jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",selectedPenerima:""},this.showAlert("Request Success","Pengeluaran berhasil buat","success"),this.fetchDataPengeluaran()}).catch(n=>{this.showAlert("Request Failed","Pengeluaran gagal buat","error"),console.error(n),this.ready=!0})},updatePengeluaran(){this.ready=!1;const s=new FormData;s.append("jumlah_transaksi",this.formUpdateTransaksi.jumlah_transaksi),s.append("deskripsi",this.formUpdateTransaksi.deskripsi),s.append("tgl_transaksi",this.formUpdateTransaksi.tgl_transaksi),s.append("id_pengirim",this.user_id),s.append("id_penerima",this.selectedPenerima),p.post(`https://backend.keuanganfpti.com/api/update-transaksi/${this.formUpdateTransaksi.id}`,s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.showAlert("Request Success","Pengeluaran berhasil diupdate","success"),this.fetchDataPengeluaran()}).catch(n=>{this.showAlert("Request Failed","Pengeluaran gagal diupdate","error"),console.error(n),this.ready=!0})},deletePengeluaran(s){this.ready=!1,p.delete(`https://backend.keuanganfpti.com/api/delete-transaksi/${s}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.showAlert("Request Success","Pengeluaran berhasil dihapus","success"),this.fetchDataPengeluaran()}).catch(n=>{this.showAlert("Request Failed","Pengeluaran gagal dihapus","error"),console.error(n),this.ready=!0})},async fetchDataPengeluaran(){try{const s=await p.get(`https://backend.keuanganfpti.com/api/list-pengeluaran/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.pengeluaran=s.data.data,this.ready=!0}catch(s){this.ready=!0,console.error(s)}},async fetchDataPenerima(){try{const s=await p.get("https://backend.keuanganfpti.com/api/list-penerima",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.penerimas=s.data.data,console.log("test penerima:",this.penerimas)}catch(s){console.error(s)}},showAlert(s,n,l){this.$swal({title:s,text:n,icon:l}).then(()=>{$("#addPengeluaran").modal("hide"),$("#editTransaksi").modal("hide")})},konfirmasi(s,n){j.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus pengeluaran ke ${n}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deletePengeluaran(s)})}},computed:{formatCurrency:function(){return function(s){return s?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s):"Rp 0,00"}}},created(){const s=sessionStorage.getItem("token");if(s)try{const[n,l]=s.split("."),m=JSON.parse(atob(n)),t=atob(l),o=JSON.parse(atob(s.split(".")[1])),a=o.exp,h=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",h.toUTCString()),new Date>h?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const k=o.level;this.user_id=o.id,console.log("ini idddd:",this.user_id),k!=="1"?this.$router.push("/unauthorized"):(!m||!t)&&this.$router.push("/"),this.fetchDataPengeluaran(),this.fetchDataPenerima()}catch(n){console.error("Error decoding token:",n),this.$router.push("/")}else this.$router.push("/")}},Je=Object.assign(Ie,{__name:"Pengeluaran",setup(s){const n=b(!1),l=b(""),m=()=>{n.value=!n.value,l.value=n.value?"toggle-sidebar":""};return(t,o)=>(r(),i(g,null,[e("div",N,[_(S,{class:T(l.value)},null,8,["class"]),e("div",F,[e("div",I,[_(B,{onToggleSidebar:m}),e("div",M,[z,e("div",R,[q,e("div",L,[K,e("div",J,[t.ready?v("",!0):(r(),i("p",E,"Loading...")),t.ready?(r(),w(C(y),{key:1,class:"display table table-striped"},{default:U(()=>[O,e("tbody",null,[(r(!0),i(g,null,f(t.pengeluaran,(a,h)=>(r(),i("tr",{key:a.id},[e("td",null,u(h+1),1),e("td",null,[e("div",H,[e("div",W,[e("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editTransaksi",onClick:k=>t.setDataUpdate(a.jumlah_transaksi,a.deskripsi,a.tgl_transaksi,a.id_penerima,a.id)},X,8,G)]),e("div",Y,[e("button",{onClick:k=>t.konfirmasi(a.id,a.nama_penerima),class:"btn btn-danger customDetail"},ee,8,Z)])])]),e("td",null,u(t.formatCurrency(a.jumlah_transaksi)),1),e("td",null,u(a.deskripsi),1),e("td",null,u(a.tgl_transaksi),1),e("td",null,u(a.nama_penerima),1)]))),128))])]),_:1})):v("",!0)])]),ae])])]),_(A)])]),e("div",se,[e("div",te,[e("div",ne,[oe,e("div",le,[e("form",null,[e("div",re,[ie,d(e("input",{type:"number",class:"form-control",id:"mapel",placeholder:"masukkan nominal pengeluaran","onUpdate:modelValue":o[0]||(o[0]=a=>t.formPengeluaran.jumlah_transaksi=a)},null,512),[[c,t.formPengeluaran.jumlah_transaksi]])]),e("div",de,[ue,d(e("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[1]||(o[1]=a=>t.formPengeluaran.tgl_transaksi=a)},null,512),[[c,t.formPengeluaran.tgl_transaksi]])]),e("div",ce,[me,d(e("select",{class:"form-select","onUpdate:modelValue":o[2]||(o[2]=a=>t.selectedPenerima=a)},[pe,(r(!0),i(g,null,f(t.penerimas,a=>(r(),i("option",{key:a.id,value:a.id},u(a.name),9,he))),128))],512),[[P,t.selectedPenerima]])]),e("div",ge,[ke,d(e("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan keterangan","onUpdate:modelValue":o[3]||(o[3]=a=>t.formPengeluaran.deskripsi=a)},null,512),[[c,t.formPengeluaran.deskripsi]])])])]),e("div",_e,[fe,e("button",{type:"button",class:"btn blueButton",onClick:o[4]||(o[4]=(...a)=>t.createMapel&&t.createMapel(...a))}," Simpan ")])])])]),e("div",be,[e("div",ve,[e("div",Pe,[ye,e("div",Te,[e("form",null,[e("div",we,[Ue,d(e("input",{type:"number",class:"form-control",id:"mapel",placeholder:"masukkan nominal pengeluaran","onUpdate:modelValue":o[5]||(o[5]=a=>t.formUpdateTransaksi.jumlah_transaksi=a)},null,512),[[c,t.formUpdateTransaksi.jumlah_transaksi]])]),e("div",Ce,[De,d(e("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[6]||(o[6]=a=>t.formUpdateTransaksi.tgl_transaksi=a)},null,512),[[c,t.formUpdateTransaksi.tgl_transaksi]])]),e("div",Se,[Be,d(e("select",{class:"form-select","onUpdate:modelValue":o[7]||(o[7]=a=>t.selectedPenerima=a)},[Ae,(r(!0),i(g,null,f(t.penerimas,a=>(r(),i("option",{key:a.id,value:a.id},u(a.name),9,je))),128))],512),[[P,t.selectedPenerima]])]),e("div",Ve,[$e,d(e("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan keterangan","onUpdate:modelValue":o[8]||(o[8]=a=>t.formUpdateTransaksi.deskripsi=a)},null,512),[[c,t.formUpdateTransaksi.deskripsi]])])])]),e("div",Ne,[Fe,e("button",{type:"button",class:"btn blueButton",onClick:o[9]||(o[9]=(...a)=>t.updatePengeluaran&&t.updatePengeluaran(...a))}," Simpan ")])])])])],64))}});export{Je as default};
