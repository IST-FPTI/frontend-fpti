import{r as f,b as u,f as d,g as t,i as b,n as v,l as _,c as U,z as w,A as C,j as i,v as r,F as k,y as B,B as j,C as c}from"./index-6a3474be.js";import{S as T}from"./Sidebar-3a40d533.js";import"./TimeVote-2fd43bb6.js";import{N as S,F as D}from"./Footer-3c1305de.js";import{a as g,S as H}from"./sweetalert2.all-1e3fb24f.js";import{P as y,D as A}from"./jquery.dataTables-f52bf5d6.js";const V={id:"wrapper"},F={id:"content-wrapper",class:"d-flex flex-column"},I={id:"content"},N={class:"container-fluid mt-4"},R=t("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"},"List Hutang",-1),q={class:"row"},P=t("div",{class:"col-1"},null,-1),z={class:"col-10"},J=B('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addHutang"><i class="bi bi-plus-circle-fill"></i> Hutang </button></div><div class="col-6"></div></div>',1),L={class:"table-responsive"},M={key:0,class:"text-center"},E=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Aksi"),t("th",{scope:"col"},"Piutang"),t("th",{scope:"col"},"Jumlah"),t("th",{scope:"col"},"Tanggal"),t("th",{scope:"col"},"Jatuh Tempo"),t("th",{scope:"col"},"Status"),t("th",{scope:"col"},"Catatan")])],-1),O={class:"row"},K={class:"col-4"},G=["onClick"],W=t("i",{class:"bi bi-cash-coin"},null,-1),Q=[W],X={class:"col-4"},Y=["onClick"],Z=t("i",{class:"bi bi-pencil-square"},null,-1),x=[Z],tt={class:"col-4"},at=["onClick"],et=t("i",{class:"bi bi-trash3"},null,-1),st=[et],nt={key:0,class:"bi bi-hourglass-split fs-5 text-danger"},ot={key:1,class:"bi bi-check-circle-fill fs-5 text-success"},lt=t("div",{class:"col-1"},null,-1),it={class:"modal fade",id:"addHutang",tabindex:"-1",role:"dialog","aria-labelledby":"addHutangLabel","aria-hidden":"true"},rt={class:"modal-dialog",role:"document"},ut={class:"modal-content"},dt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addHutangLabel"},"Masukkan Hutang"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),ct={class:"modal-body"},ht={class:"mb-3"},gt=t("label",{for:"ketua",class:"form-label"},"Piutang",-1),mt={class:"mb-3"},pt=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),_t={class:"mb-3"},bt=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),ft={class:"mb-3"},kt=t("label",{for:"ketua",class:"form-label"},"Tanggal Jatuh Tempo",-1),Ht={class:"mb-3"},yt=t("label",{for:"keterangan",class:"form-label"},"Catatan",-1),vt={class:"modal-footer"},Ut=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),wt={class:"modal fade",id:"editTransaksi",tabindex:"-1",role:"dialog","aria-labelledby":"editTransaksiLabel","aria-hidden":"true"},Ct={class:"modal-dialog",role:"document"},Bt={class:"modal-content"},jt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editTransaksiLabel"},"Edit Pengeluaran"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),Tt={class:"modal-body"},St={class:"mb-3"},Dt=t("label",{for:"ketua",class:"form-label"},"Piutang",-1),At={class:"mb-3"},Vt=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),$t={class:"mb-3"},Ft=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),It={class:"mb-3"},Nt=t("label",{for:"ketua",class:"form-label"},"Tanggal Jatuh Tempo",-1),Rt={class:"mb-3"},qt=t("label",{for:"keterangan",class:"form-label"},"Catatan",-1),Pt={class:"modal-footer"},zt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(A);const Jt={data(){return{hutangs:[],formHutang:{pemberi_hutang:"",jumlah_hutang:"",tanggal_hutang:"",tgl_jatuh_tempo:"",catatan:""},formUpdateHutang:{pemberi_hutang:"",jumlah_hutang:"",tanggal_hutang:"",tgl_jatuh_tempo:"",catatan:""},ready:!1,transaksi_id:"",selectedPenerima:"",user_id:"",hutang_id:""}},methods:{setDataUpdate(e,n,l,h,s,o){this.formUpdateHutang.pemberi_hutang=e,this.formUpdateHutang.jumlah_hutang=n,this.formUpdateHutang.tanggal_hutang=l,this.formUpdateHutang.tgl_jatuh_tempo=s,this.formUpdateHutang.catatan=h,this.hutang_id=o},createHutang(){this.ready=!1;const e=new FormData;e.append("pemberi_hutang",this.formHutang.pemberi_hutang),e.append("jumlah_hutang",this.formHutang.jumlah_hutang),e.append("tanggal_hutang",this.formHutang.tanggal_hutang),e.append("tgl_jatuh_tempo",this.formHutang.tgl_jatuh_tempo),e.append("catatan",this.formHutang.catatan),e.append("id_user",this.user_id),g.post("https://backend.keuanganfpti.com/api/create-hutangpiutang",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.formHutang={jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",selectedPenerima:""},this.showAlert("Request Success","Hutang berhasil buat","success"),this.fetchDataHutang()}).catch(n=>{this.showAlert("Request Failed","Hutang gagal buat","error"),console.error(n),this.ready=!0})},updateHutang(){this.ready=!1;const e=new FormData;e.append("pemberi_hutang",this.formUpdateHutang.pemberi_hutang),e.append("jumlah_hutang",this.formUpdateHutang.jumlah_hutang),e.append("tanggal_hutang",this.formUpdateHutang.tanggal_hutang),e.append("tgl_jatuh_tempo",this.formUpdateHutang.tgl_jatuh_tempo),e.append("catatan",this.formUpdateHutang.catatan),e.append("id_user",this.user_id),g.post(`https://backend.keuanganfpti.com/api/update-hutangpiutang/${this.hutang_id}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.formHutang={nama_mapel:""},this.showAlert("Request Success","Hutang berhasil diupdate","success"),this.fetchDataHutang()}).catch(n=>{this.showAlert("Request Failed","Hutang gagal diupdate","error"),console.error(n),this.ready=!0})},deleteHutang(e){this.ready=!1,g.delete(`https://backend.keuanganfpti.com/api/delete-hutangpiutang/${e}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.showAlert("Request Success","Hutang berhasil dihapus","success"),this.fetchDataHutang()}).catch(n=>{this.showAlert("Request Failed","Hutang gagal dihapus","error"),console.error(n),this.ready=!0})},async fetchDataHutang(){try{const e=await g.get("https://backend.keuanganfpti.com/api/list-hutangpiutang",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.hutangs=e.data.data,this.ready=!0}catch(e){console.error(e)}},async bayarHutang(e){try{const n=await g.post(`https://backend.keuanganfpti.com/api/bayar-hutangpiutang/${e}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.showAlert("Request Success","Hutang berhasil dibayarkan","success"),this.ready=!0}catch(n){console.error(n),this.showAlert("Request Failed","Gagal membayar hutang, pastikan saldo anda cukup","error")}},showAlert(e,n,l){this.$swal({title:e,text:n,icon:l}).then(()=>{$("#addHutang").modal("hide"),$("#editTransaksi").modal("hide")})},konfirmasiBayar(e,n){H.fire({title:`Apakah Anda yakin ingin membayar Hutang ke ${n}?`,text:"Pastikan saldo anda cukup.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#fac800",cancelButtonColor:"#d33",confirmButtonText:"Bayar",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.bayarHutang(e)})},konfirmasiDelete(e,n){H.fire({title:`Apakah Anda yakin ingin menghapus hutang dari ${n}?`,text:"Anda akan keluar dari akun ini.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deleteHutang(e)})}},computed:{formatCurrency:function(){return function(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp 0,00"}}},created(){const e=sessionStorage.getItem("token");if(e)try{const[n,l]=e.split("."),h=JSON.parse(atob(n)),s=atob(l),o=JSON.parse(atob(e.split(".")[1])),a=o.exp,m=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",m.toUTCString()),new Date>m?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const p=o.level;this.user_id=o.id,console.log("ini idddd:",this.user_id),p!=="1"?this.$router.push("/unauthorized"):(!h||!s)&&this.$router.push("/"),this.fetchDataHutang()}catch(n){console.error("Error decoding token:",n),this.$router.push("/")}else this.$router.push("/")}},Wt=Object.assign(Jt,{__name:"Hutang",setup(e){const n=f(!1),l=f(""),h=()=>{n.value=!n.value,l.value=n.value?"toggle-sidebar":""};return(s,o)=>(u(),d(k,null,[t("div",V,[b(T,{class:v(l.value)},null,8,["class"]),t("div",F,[t("div",I,[b(S,{onToggleSidebar:h}),t("div",N,[R,t("div",q,[P,t("div",z,[J,t("div",L,[s.ready?_("",!0):(u(),d("p",M,"Loading...")),s.ready?(u(),U(C(y),{key:1,class:"display table table-striped"},{default:w(()=>[E,t("tbody",null,[(u(!0),d(k,null,j(s.hutangs,(a,m)=>(u(),d("tr",{key:a.id},[t("td",null,c(m+1),1),t("td",null,[t("div",O,[t("div",K,[t("button",{type:"button",class:"btn btn-success",onClick:p=>s.konfirmasiBayar(a.id,a.pemberi_hutang)},Q,8,G)]),t("div",X,[t("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editTransaksi",onClick:p=>s.setDataUpdate(a.pemberi_hutang,a.jumlah_hutang,a.tanggal_hutang,a.catatan,a.tgl_jatuh_tempo,a.id)},x,8,Y)]),t("div",tt,[t("button",{onClick:p=>s.konfirmasiDelete(a.id,a.pemberi_hutang),class:"btn btn-danger customDetail"},st,8,at)])])]),t("td",null,c(a.pemberi_hutang),1),t("td",null,c(s.formatCurrency(a.jumlah_hutang)),1),t("td",null,c(a.tanggal_hutang),1),t("td",null,c(a.tgl_jatuh_tempo),1),t("td",null,[a.status=="0"?(u(),d("i",nt)):_("",!0),a.status=="1"?(u(),d("i",ot)):_("",!0)]),t("td",null,c(a.catatan),1)]))),128))])]),_:1})):_("",!0)])]),lt])])]),b(D)])]),t("div",it,[t("div",rt,[t("div",ut,[dt,t("div",ct,[t("form",null,[t("div",ht,[gt,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan pemberi hutang","onUpdate:modelValue":o[0]||(o[0]=a=>s.formHutang.pemberi_hutang=a)},null,512),[[r,s.formHutang.pemberi_hutang]])]),t("div",mt,[pt,i(t("input",{type:"number",class:"form-control",id:"mapel",placeholder:"masukkan nominal hutang","onUpdate:modelValue":o[1]||(o[1]=a=>s.formHutang.jumlah_hutang=a)},null,512),[[r,s.formHutang.jumlah_hutang]])]),t("div",_t,[bt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[2]||(o[2]=a=>s.formHutang.tanggal_hutang=a)},null,512),[[r,s.formHutang.tanggal_hutang]])]),t("div",ft,[kt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[3]||(o[3]=a=>s.formHutang.tgl_jatuh_tempo=a)},null,512),[[r,s.formHutang.tgl_jatuh_tempo]])]),t("div",Ht,[yt,i(t("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan keterangan","onUpdate:modelValue":o[4]||(o[4]=a=>s.formHutang.catatan=a)},null,512),[[r,s.formHutang.catatan]])])])]),t("div",vt,[Ut,t("button",{type:"button",class:"btn blueButton",onClick:o[5]||(o[5]=(...a)=>s.createHutang&&s.createHutang(...a))}," Simpan ")])])])]),t("div",wt,[t("div",Ct,[t("div",Bt,[jt,t("div",Tt,[t("form",null,[t("div",St,[Dt,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan pemberi hutang","onUpdate:modelValue":o[6]||(o[6]=a=>s.formUpdateHutang.pemberi_hutang=a)},null,512),[[r,s.formUpdateHutang.pemberi_hutang]])]),t("div",At,[Vt,i(t("input",{type:"number",class:"form-control",id:"mapel",placeholder:"masukkan nominal hutang","onUpdate:modelValue":o[7]||(o[7]=a=>s.formUpdateHutang.jumlah_hutang=a)},null,512),[[r,s.formUpdateHutang.jumlah_hutang]])]),t("div",$t,[Ft,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[8]||(o[8]=a=>s.formUpdateHutang.tanggal_hutang=a)},null,512),[[r,s.formUpdateHutang.tanggal_hutang]])]),t("div",It,[Nt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":o[9]||(o[9]=a=>s.formUpdateHutang.tgl_jatuh_tempo=a)},null,512),[[r,s.formUpdateHutang.tgl_jatuh_tempo]])]),t("div",Rt,[qt,i(t("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan keterangan","onUpdate:modelValue":o[10]||(o[10]=a=>s.formUpdateHutang.catatan=a)},null,512),[[r,s.formUpdateHutang.catatan]])])])]),t("div",Pt,[zt,t("button",{type:"button",class:"btn blueButton",onClick:o[11]||(o[11]=(...a)=>s.updateHutang&&s.updateHutang(...a))}," Simpan ")])])])])],64))}});export{Wt as default};
