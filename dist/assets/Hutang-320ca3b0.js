import{r as k,b as r,f as g,g as t,i as f,n as U,l as v,c as j,G as w,K as D,j as l,v as i,L as H,F as m,H as b,J as S,I as u}from"./index-3985fc61.js";import{S as B,N as C,F as A}from"./Footer-f4d60248.js";import{P as y,D as T}from"./TimeVote-f1f5dff7.js";import{a as c}from"./_commonjsHelpers-34c3cec1.js";import{S as V}from"./sweetalert2.all-777e80f8.js";const E={id:"wrapper"},I={id:"content-wrapper",class:"d-flex flex-column"},P={id:"content"},F={class:"container-fluid mt-4"},N=t("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," Data Hutang ",-1),J={class:"row"},R=t("div",{class:"col-1"},null,-1),q={class:"col-10"},z=S('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addHutang"><i class="bi bi-plus-circle-fill"></i> Buat Pengeluaran </button></div><div class="col-6"></div></div>',1),K={class:"table-responsive"},L={key:0,class:"text-center"},M=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Aksi"),t("th",{scope:"col"},"Keperluan"),t("th",{scope:"col"},"Jumlah Hutang"),t("th",{scope:"col"},"Deskripsi Hutang"),t("th",{scope:"col"},"Tanggal Hutang"),t("th",{scope:"col"},"Jatuh Tempo"),t("th",{scope:"col"},"Status")])],-1),O={class:"row"},G={class:"col-6"},W=["onClick"],Q=t("i",{class:"bi bi-pencil-square"},null,-1),X=[Q],Y={class:"col-6"},Z=["onClick"],x=t("i",{class:"bi bi-trash3"},null,-1),tt=[x],at=t("div",{class:"col-1"},null,-1),et={class:"modal fade",id:"addHutang",tabindex:"-1",role:"dialog","aria-labelledby":"addHutangLabel","aria-hidden":"true"},st={class:"modal-dialog",role:"document"},nt={class:"modal-content"},ot=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addHutangLabel"}," Buat Hutang "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),lt={class:"modal-body"},ut={class:"mb-3"},dt=t("label",{for:"ketua",class:"form-label"},"Kebutuhan",-1),it={class:"mb-3"},rt=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),gt={class:"mb-3"},ht=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),ct={class:"mb-3"},pt=t("label",{for:"ketua",class:"form-label"},"Jatuh Tempo",-1),mt={class:"mb-3"},_t=t("label",{for:"mission",class:"form-label"},"Events",-1),ft=t("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),bt=["value"],kt={class:"mb-3"},vt=t("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),Ht={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),Ut={class:"modal fade",id:"editPengeluaran",tabindex:"-1",role:"dialog","aria-labelledby":"editPengeluaranLabel","aria-hidden":"true"},jt={class:"modal-dialog",role:"document"},wt={class:"modal-content"},Dt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editPengeluaranLabel"},"Edit Hutang"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),St={class:"modal-body"},Bt={class:"mb-3"},Ct=t("label",{for:"ketua",class:"form-label"},"Kebutuhan",-1),At={class:"mb-3"},Tt=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),Vt={class:"mb-3"},$t=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),Et={class:"mb-3"},It=t("label",{for:"ketua",class:"form-label"},"Jatuh Tempo",-1),Pt={class:"mb-3"},Ft=t("label",{for:"mission",class:"form-label"},"Events",-1),Nt=t("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),Jt=["value"],Rt={class:"mb-3"},qt=t("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),zt={class:"modal-footer"},Kt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(T);const Lt={data(){return{hutangs:[],events:[],formHutang:{keperluan_hutang:"",jumlah_hutang:"",deskripsi_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:""},formUpdateHutang:{keperluan_hutang:"",jumlah_hutang:"",deskripsi_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:"",id_hutang:""},ready:!1,selectedEvent:"",user_id:""}},methods:{setDataUpdate(e,o,d,h,s,n){this.formUpdateHutang.keperluan_hutang=e,this.formUpdateHutang.jumlah_hutang=o,this.formUpdateHutang.deskripsi_hutang=d,this.formUpdateHutang.tanggal_hutang=h,this.formUpdateHutang.tanggal_jatuh_tempo=s,this.formUpdateHutang.id_hutang=n},createHutang(){this.ready=!1;const e=new FormData;e.append("keperluan_hutang",this.formHutang.keperluan_hutang),e.append("jumlah_hutang",this.formHutang.jumlah_hutang),e.append("tanggal_hutang",this.formHutang.tanggal_hutang),e.append("tanggal_jatuh_tempo",this.formHutang.tanggal_jatuh_tempo),e.append("deskripsi_hutang",this.formHutang.deskripsi_pengeluaran),e.append("id_event",this.selectedEvent),c.post("https://backend.keuanganfpti.com/api/create-hutang",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.formHutang={keperluan_hutang:"",jumlah_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:"",deskripsi_hutang:"",selectedEvent:""},this.showAlert("Request Success","Hutang berhasil buat","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal buat","error"),console.error(o),this.ready=!0})},updateHutang(){this.ready=!1;const e=new FormData;e.append("keperluan_hutang",this.formUpdateHutang.keperluan_hutang),e.append("jumlah_hutang",this.formUpdateHutang.jumlah_hutang),e.append("deskripsi_hutang",this.formUpdateHutang.deskripsi_hutang),e.append("tanggal_hutang",this.formUpdateHutang.tanggal_hutang),e.append("tanggal_jatuh_tempo",this.formUpdateHutang.tanggal_jatuh_tempo),e.append("id_event",this.selectedEvent),c.post(`https://backend.keuanganfpti.com/api/update-hutang/${this.formUpdateHutang.id_hutang}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Hutang berhasil diupdate","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal diupdate","error"),console.error(o),this.ready=!0})},deleteHutang(e){this.ready=!1,c.delete(`https://backend.keuanganfpti.com/api/delete-hutang/${e}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Hutang berhasil dihapus","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal dihapus","error"),console.error(o),this.ready=!0})},async fetchDataHutang(){try{const e=await c.get("https://backend.keuanganfpti.com/api/list-hutang",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.hutangs=e.data.data,this.ready=!0}catch(e){this.ready=!0,console.error(e)}},async fetchDataActiveEvent(){try{const e=await c.get("https://backend.keuanganfpti.com/api/event-active",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.events=e.data.data}catch(e){console.error(e)}},showAlert(e,o,d){this.$swal({title:e,text:o,icon:d}).then(()=>{$("#addHutang").modal("hide"),$("#editPengeluaran").modal("hide")})},konfirmasi(e,o){V.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus hutang ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(d=>{d.isConfirmed&&this.deleteHutang(e)})}},computed:{formatCurrency:function(){return function(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp 0,00"}}},created(){const e=sessionStorage.getItem("token");if(e)try{const[o,d]=e.split("."),h=JSON.parse(atob(o)),s=atob(d),n=JSON.parse(atob(e.split(".")[1])),a=n.exp,p=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const _=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),_!=="1"?this.$router.push("/unauthorized"):(!h||!s)&&this.$router.push("/"),this.fetchDataHutang(),this.fetchDataActiveEvent()}catch(o){console.error("Error decoding token:",o),this.$router.push("/")}else this.$router.push("/")}},Xt=Object.assign(Lt,{__name:"Hutang",setup(e){const o=k(!1),d=k(""),h=()=>{o.value=!o.value,d.value=o.value?"toggle-sidebar":""};return(s,n)=>(r(),g(m,null,[t("div",E,[f(B,{class:U(d.value)},null,8,["class"]),t("div",I,[t("div",P,[f(C,{onToggleSidebar:h}),t("div",F,[N,t("div",J,[R,t("div",q,[z,t("div",K,[s.ready?v("",!0):(r(),g("p",L,"Loading...")),s.ready?(r(),j(D(y),{key:1,class:"display table table-striped"},{default:w(()=>[M,t("tbody",null,[(r(!0),g(m,null,b(s.hutangs,(a,p)=>(r(),g("tr",{key:a.id},[t("td",null,u(p+1),1),t("td",null,[t("div",O,[t("div",G,[t("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editPengeluaran",onClick:_=>s.setDataUpdate(a.keperluan_hutang,a.jumlah_hutang,a.deskripsi_hutang,a.tanggal_hutang,a.tanggal_jatuh_tempo,a.id)},X,8,W)]),t("div",Y,[t("button",{onClick:_=>s.konfirmasi(a.id,a.keperluan_hutang),class:"btn btn-danger customDetail"},tt,8,Z)])])]),t("td",null,u(a.keperluan_hutang),1),t("td",null,u(a.jumlah_hutang),1),t("td",null,u(a.deskripsi_hutang),1),t("td",null,u(a.tanggal_hutang),1),t("td",null,u(a.tanggal_jatuh_tempo),1),t("td",null,u(a.status),1)]))),128))])]),_:1})):v("",!0)])]),at])])]),f(A)])]),t("div",et,[t("div",st,[t("div",nt,[ot,t("div",lt,[t("form",null,[t("div",ut,[dt,l(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan kebutuhan","onUpdate:modelValue":n[0]||(n[0]=a=>s.formHutang.keperluan_hutang=a)},null,512),[[i,s.formHutang.keperluan_hutang]])]),t("div",it,[rt,l(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan jumlah pengeluaran","onUpdate:modelValue":n[1]||(n[1]=a=>s.formHutang.jumlah_hutang=a)},null,512),[[i,s.formHutang.jumlah_hutang]])]),t("div",gt,[ht,l(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[2]||(n[2]=a=>s.formHutang.tanggal_hutang=a)},null,512),[[i,s.formHutang.tanggal_hutang]])]),t("div",ct,[pt,l(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[3]||(n[3]=a=>s.formHutang.tanggal_jatuh_tempo=a)},null,512),[[i,s.formHutang.tanggal_jatuh_tempo]])]),t("div",mt,[_t,l(t("select",{class:"form-select","onUpdate:modelValue":n[4]||(n[4]=a=>s.selectedEvent=a)},[ft,(r(!0),g(m,null,b(s.events,a=>(r(),g("option",{key:a.id,value:a.id},u(a.nama_event)+" - "+u(a.tanggal_event),9,bt))),128))],512),[[H,s.selectedEvent]])]),t("div",kt,[vt,l(t("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan deskripsi","onUpdate:modelValue":n[5]||(n[5]=a=>s.formHutang.deskripsi_hutang=a)},null,512),[[i,s.formHutang.deskripsi_hutang]])])])]),t("div",Ht,[yt,t("button",{type:"button",class:"btn blueButton",onClick:n[6]||(n[6]=(...a)=>s.createHutang&&s.createHutang(...a))}," Simpan ")])])])]),t("div",Ut,[t("div",jt,[t("div",wt,[Dt,t("div",St,[t("form",null,[t("div",Bt,[Ct,l(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan kebutuhan","onUpdate:modelValue":n[7]||(n[7]=a=>s.formUpdateHutang.keperluan_hutang=a)},null,512),[[i,s.formUpdateHutang.keperluan_hutang]])]),t("div",At,[Tt,l(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan jumlah pengeluaran","onUpdate:modelValue":n[8]||(n[8]=a=>s.formUpdateHutang.jumlah_hutang=a)},null,512),[[i,s.formUpdateHutang.jumlah_hutang]])]),t("div",Vt,[$t,l(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[9]||(n[9]=a=>s.formUpdateHutang.tanggal_hutang=a)},null,512),[[i,s.formUpdateHutang.tanggal_hutang]])]),t("div",Et,[It,l(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[10]||(n[10]=a=>s.formUpdateHutang.tanggal_jatuh_tempo=a)},null,512),[[i,s.formUpdateHutang.tanggal_jatuh_tempo]])]),t("div",Pt,[Ft,l(t("select",{class:"form-select","onUpdate:modelValue":n[11]||(n[11]=a=>s.selectedEvent=a)},[Nt,(r(!0),g(m,null,b(s.events,a=>(r(),g("option",{key:a.id,value:a.id},u(a.nama_event)+" - "+u(a.tanggal_event),9,Jt))),128))],512),[[H,s.selectedEvent]])]),t("div",Rt,[qt,l(t("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan deskripsi","onUpdate:modelValue":n[12]||(n[12]=a=>s.formUpdateHutang.deskripsi_hutang=a)},null,512),[[i,s.formUpdateHutang.deskripsi_hutang]])])])]),t("div",zt,[Kt,t("button",{type:"button",class:"btn blueButton",onClick:n[13]||(n[13]=(...a)=>s.updateHutang&&s.updateHutang(...a))}," Simpan ")])])])])],64))}});export{Xt as default};
