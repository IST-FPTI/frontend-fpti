import{r as v,b as u,f as r,g as t,i as b,n as w,l as _,c as B,G as j,J as C,j as i,v as d,L as H,F as f,H as k,K as D,I as h}from"./index-c4c3c49d.js";import{S,N as A,F as T}from"./Footer-48849b32.js";import{P as U,D as V}from"./TimeVote-c8e460eb.js";import{a as g}from"./_commonjsHelpers-34c3cec1.js";import{S as y}from"./sweetalert2.all-777e80f8.js";const I={id:"wrapper"},P={id:"content-wrapper",class:"d-flex flex-column"},E={id:"content"},F={class:"container-fluid mt-4"},N=t("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," Data Hutang ",-1),R={class:"row"},q=t("div",{class:"col-1"},null,-1),J={class:"col-10"},z=D('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addHutang"><i class="bi bi-plus-circle-fill"></i> Buat Pengeluaran </button></div><div class="col-6"></div></div>',1),K={class:"table-responsive"},L={key:0,class:"text-center"},O=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Aksi"),t("th",{scope:"col"},"Keperluan"),t("th",{scope:"col"},"Jumlah Hutang"),t("th",{scope:"col"},"Deskripsi Hutang"),t("th",{scope:"col"},"Tanggal Hutang"),t("th",{scope:"col"},"Jatuh Tempo"),t("th",{scope:"col"},"Status")])],-1),G={class:"row"},M={class:"col-4"},W=["onClick"],Q=t("i",{class:"bi bi-cash-coin"},null,-1),X=[Q],Y={class:"col-4"},Z=["onClick"],x=t("i",{class:"bi bi-pencil-square"},null,-1),tt=[x],at={class:"col-4"},et=["onClick"],st=t("i",{class:"bi bi-trash3"},null,-1),nt=[st],ot={key:0,class:"bi bi-hourglass-split fs-5 text-danger"},lt={key:1,class:"bi bi-check-circle-fill fs-5 text-success"},it=t("div",{class:"col-1"},null,-1),ut={class:"modal fade",id:"addHutang",tabindex:"-1",role:"dialog","aria-labelledby":"addHutangLabel","aria-hidden":"true"},rt={class:"modal-dialog",role:"document"},dt={class:"modal-content"},ht=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addHutangLabel"}," Buat Hutang "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),gt={class:"modal-body"},ct={class:"mb-3"},pt=t("label",{for:"ketua",class:"form-label"},"Kebutuhan",-1),mt={class:"mb-3"},_t=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),ft={class:"mb-3"},bt=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),kt={class:"mb-3"},vt=t("label",{for:"ketua",class:"form-label"},"Jatuh Tempo",-1),Ht={class:"mb-3"},yt=t("label",{for:"mission",class:"form-label"},"Events",-1),Ut=t("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),wt=["value"],Bt={class:"mb-3"},jt=t("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),Ct={class:"modal-footer"},Dt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),St={class:"modal fade",id:"editPengeluaran",tabindex:"-1",role:"dialog","aria-labelledby":"editPengeluaranLabel","aria-hidden":"true"},At={class:"modal-dialog",role:"document"},Tt={class:"modal-content"},Vt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editPengeluaranLabel"},"Edit Hutang"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1),$t={class:"modal-body"},It={class:"mb-3"},Pt=t("label",{for:"ketua",class:"form-label"},"Kebutuhan",-1),Et={class:"mb-3"},Ft=t("label",{for:"ketua",class:"form-label"},"Jumlah Hutang",-1),Nt={class:"mb-3"},Rt=t("label",{for:"ketua",class:"form-label"},"Tanggal Hutang",-1),qt={class:"mb-3"},Jt=t("label",{for:"ketua",class:"form-label"},"Jatuh Tempo",-1),zt={class:"mb-3"},Kt=t("label",{for:"mission",class:"form-label"},"Events",-1),Lt=t("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),Ot=["value"],Gt={class:"mb-3"},Mt=t("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),Wt={class:"modal-footer"},Qt=t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);U.use(V);const Xt={data(){return{hutangs:[],events:[],formHutang:{keperluan_hutang:"",jumlah_hutang:"",deskripsi_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:""},formUpdateHutang:{keperluan_hutang:"",jumlah_hutang:"",deskripsi_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:"",id_hutang:""},ready:!1,selectedEvent:"",user_id:""}},methods:{setDataUpdate(e,o,l,c,s,n){this.formUpdateHutang.keperluan_hutang=e,this.formUpdateHutang.jumlah_hutang=o,this.formUpdateHutang.deskripsi_hutang=l,this.formUpdateHutang.tanggal_hutang=c,this.formUpdateHutang.tanggal_jatuh_tempo=s,this.formUpdateHutang.id_hutang=n},createHutang(){this.ready=!1;const e=new FormData;e.append("keperluan_hutang",this.formHutang.keperluan_hutang),e.append("jumlah_hutang",this.formHutang.jumlah_hutang),e.append("tanggal_hutang",this.formHutang.tanggal_hutang),e.append("tanggal_jatuh_tempo",this.formHutang.tanggal_jatuh_tempo),e.append("deskripsi_hutang",this.formHutang.deskripsi_pengeluaran),e.append("id_event",this.selectedEvent),g.post("https://backend.keuanganfpti.com/api/create-hutang",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.formHutang={keperluan_hutang:"",jumlah_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:"",deskripsi_hutang:"",selectedEvent:""},this.showAlert("Request Success","Hutang berhasil buat","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal buat","error"),console.error(o),this.ready=!0})},updateHutang(){this.ready=!1;const e=new FormData;e.append("keperluan_hutang",this.formUpdateHutang.keperluan_hutang),e.append("jumlah_hutang",this.formUpdateHutang.jumlah_hutang),e.append("deskripsi_hutang",this.formUpdateHutang.deskripsi_hutang),e.append("tanggal_hutang",this.formUpdateHutang.tanggal_hutang),e.append("tanggal_jatuh_tempo",this.formUpdateHutang.tanggal_jatuh_tempo),e.append("id_event",this.selectedEvent),g.post(`https://backend.keuanganfpti.com/api/update-hutang/${this.formUpdateHutang.id_hutang}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Hutang berhasil diupdate","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal diupdate","error"),console.error(o),this.ready=!0})},deleteHutang(e){this.ready=!1,g.delete(`https://backend.keuanganfpti.com/api/delete-hutang/${e}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Hutang berhasil dihapus","success"),this.fetchDataHutang()}).catch(o=>{this.showAlert("Request Failed","Hutang gagal dihapus","error"),console.error(o),this.ready=!0})},async fetchDataHutang(){try{const e=await g.get("https://backend.keuanganfpti.com/api/list-hutang",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.hutangs=e.data.data,this.ready=!0}catch(e){this.ready=!0,console.error(e)}},async fetchDataActiveEvent(){try{const e=await g.get("https://backend.keuanganfpti.com/api/event-active",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.events=e.data.data}catch(e){console.error(e)}},async bayarHutang(e){try{const o=await g.post(`https://backend.keuanganfpti.com/api/bayar-hutang/${e}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.showAlert("Request Success","Hutang berhasil dibayarkan","success"),this.ready=!0}catch(o){console.error(o),this.showAlert("Request Failed","Gagal membayar hutang, pastikan saldo anda cukup","error")}},showAlert(e,o,l){this.$swal({title:e,text:o,icon:l}).then(()=>{$("#addHutang").modal("hide"),$("#editPengeluaran").modal("hide")})},konfirmasiBayar(e,o){y.fire({title:`Apakah Anda yakin ingin membayar hutang ${o}?`,text:"Pastikan saldo anda cukup.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#fac800",cancelButtonColor:"#d33",confirmButtonText:"Bayar",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.bayarHutang(e)})},konfirmasi(e,o){y.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus hutang ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&this.deleteHutang(e)})}},computed:{formatCurrency:function(){return function(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp 0,00"}}},created(){const e=sessionStorage.getItem("token");if(e)try{const[o,l]=e.split("."),c=JSON.parse(atob(o)),s=atob(l),n=JSON.parse(atob(e.split(".")[1])),a=n.exp,p=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const m=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),m!=="1"?this.$router.push("/unauthorized"):(!c||!s)&&this.$router.push("/"),this.fetchDataHutang(),this.fetchDataActiveEvent()}catch(o){console.error("Error decoding token:",o),this.$router.push("/")}else this.$router.push("/")}},ea=Object.assign(Xt,{__name:"Hutang",setup(e){const o=v(!1),l=v(""),c=()=>{o.value=!o.value,l.value=o.value?"toggle-sidebar":""};return(s,n)=>(u(),r(f,null,[t("div",I,[b(S,{class:w(l.value)},null,8,["class"]),t("div",P,[t("div",E,[b(A,{onToggleSidebar:c}),t("div",F,[N,t("div",R,[q,t("div",J,[z,t("div",K,[s.ready?_("",!0):(u(),r("p",L,"Loading...")),s.ready?(u(),B(C(U),{key:1,class:"display table table-striped"},{default:j(()=>[O,t("tbody",null,[(u(!0),r(f,null,k(s.hutangs,(a,p)=>(u(),r("tr",{key:a.id},[t("td",null,h(p+1),1),t("td",null,[t("div",G,[t("div",M,[t("button",{type:"button",class:"btn btn-success",onClick:m=>s.konfirmasiBayar(a.id,a.keperluan_hutang)},X,8,W)]),t("div",Y,[t("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editPengeluaran",onClick:m=>s.setDataUpdate(a.keperluan_hutang,a.jumlah_hutang,a.deskripsi_hutang,a.tanggal_hutang,a.tanggal_jatuh_tempo,a.id)},tt,8,Z)]),t("div",at,[t("button",{onClick:m=>s.konfirmasi(a.id,a.keperluan_hutang),class:"btn btn-danger customDetail"},nt,8,et)])])]),t("td",null,h(a.keperluan_hutang),1),t("td",null,h(a.jumlah_hutang),1),t("td",null,h(a.deskripsi_hutang),1),t("td",null,h(a.tanggal_hutang),1),t("td",null,h(a.tanggal_jatuh_tempo),1),t("td",null,[a.status=="0"?(u(),r("i",ot)):_("",!0),a.status=="1"?(u(),r("i",lt)):_("",!0)])]))),128))])]),_:1})):_("",!0)])]),it])])]),b(T)])]),t("div",ut,[t("div",rt,[t("div",dt,[ht,t("div",gt,[t("form",null,[t("div",ct,[pt,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan kebutuhan","onUpdate:modelValue":n[0]||(n[0]=a=>s.formHutang.keperluan_hutang=a)},null,512),[[d,s.formHutang.keperluan_hutang]])]),t("div",mt,[_t,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan jumlah hutang","onUpdate:modelValue":n[1]||(n[1]=a=>s.formHutang.jumlah_hutang=a)},null,512),[[d,s.formHutang.jumlah_hutang]])]),t("div",ft,[bt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[2]||(n[2]=a=>s.formHutang.tanggal_hutang=a)},null,512),[[d,s.formHutang.tanggal_hutang]])]),t("div",kt,[vt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[3]||(n[3]=a=>s.formHutang.tanggal_jatuh_tempo=a)},null,512),[[d,s.formHutang.tanggal_jatuh_tempo]])]),t("div",Ht,[yt,i(t("select",{class:"form-select","onUpdate:modelValue":n[4]||(n[4]=a=>s.selectedEvent=a)},[Ut,(u(!0),r(f,null,k(s.events,a=>(u(),r("option",{key:a.id,value:a.id},h(a.nama_event)+" - "+h(a.tanggal_event),9,wt))),128))],512),[[H,s.selectedEvent]])]),t("div",Bt,[jt,i(t("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":n[5]||(n[5]=a=>s.formHutang.deskripsi_hutang=a)},null,512),[[d,s.formHutang.deskripsi_hutang]])])])]),t("div",Ct,[Dt,t("button",{type:"button",class:"btn blueButton",onClick:n[6]||(n[6]=(...a)=>s.createHutang&&s.createHutang(...a))}," Simpan ")])])])]),t("div",St,[t("div",At,[t("div",Tt,[Vt,t("div",$t,[t("form",null,[t("div",It,[Pt,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan kebutuhan","onUpdate:modelValue":n[7]||(n[7]=a=>s.formUpdateHutang.keperluan_hutang=a)},null,512),[[d,s.formUpdateHutang.keperluan_hutang]])]),t("div",Et,[Ft,i(t("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan jumlah hutang","onUpdate:modelValue":n[8]||(n[8]=a=>s.formUpdateHutang.jumlah_hutang=a)},null,512),[[d,s.formUpdateHutang.jumlah_hutang]])]),t("div",Nt,[Rt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[9]||(n[9]=a=>s.formUpdateHutang.tanggal_hutang=a)},null,512),[[d,s.formUpdateHutang.tanggal_hutang]])]),t("div",qt,[Jt,i(t("input",{type:"date",class:"form-control",id:"mapel","onUpdate:modelValue":n[10]||(n[10]=a=>s.formUpdateHutang.tanggal_jatuh_tempo=a)},null,512),[[d,s.formUpdateHutang.tanggal_jatuh_tempo]])]),t("div",zt,[Kt,i(t("select",{class:"form-select","onUpdate:modelValue":n[11]||(n[11]=a=>s.selectedEvent=a)},[Lt,(u(!0),r(f,null,k(s.events,a=>(u(),r("option",{key:a.id,value:a.id},h(a.nama_event)+" - "+h(a.tanggal_event),9,Ot))),128))],512),[[H,s.selectedEvent]])]),t("div",Gt,[Mt,i(t("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":n[12]||(n[12]=a=>s.formUpdateHutang.deskripsi_hutang=a)},null,512),[[d,s.formUpdateHutang.deskripsi_hutang]])])])]),t("div",Wt,[Qt,t("button",{type:"button",class:"btn blueButton",onClick:n[13]||(n[13]=(...a)=>s.updateHutang&&s.updateHutang(...a))}," Simpan ")])])])])],64))}});export{ea as default};
