import{r as k,b as i,f as l,g as s,i as f,n as D,l as v,c as w,G as U,J as B,j as d,v as c,L as g,F as _,H as S,K as C,I as p}from"./index-1c32a6d8.js";import{S as A,N as T,F as V}from"./Footer-663f5f32.js";import{P as y,D as E}from"./TimeVote-b108e8d3.js";import{a as m}from"./_commonjsHelpers-34c3cec1.js";import{S as I}from"./sweetalert2.all-777e80f8.js";const F={id:"wrapper"},N={id:"content-wrapper",class:"d-flex flex-column"},P={id:"content"},R={class:"container-fluid mt-4"},q=s("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," Data Sponsor ",-1),z={class:"row"},L=s("div",{class:"col-1"},null,-1),K={class:"col-10"},J=C('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addSponsor"><i class="bi bi-plus-circle-fill"></i> Buat Sponsor </button></div><div class="col-6"></div></div>',1),O={class:"table-responsive"},j={key:0,class:"text-center"},H=s("thead",null,[s("tr",null,[s("th",{scope:"col",style:{width:"50px"}},"No"),s("th",{scope:"col"},"Aksi"),s("th",{scope:"col"},"Pemberi Sponsor"),s("th",{scope:"col"},"Dana Sponsor"),s("th",{scope:"col"},"Deskripsi Sponsor")])],-1),M={class:"row"},G={class:"col-6"},W=["onClick"],Q=s("i",{class:"bi bi-pencil-square"},null,-1),X=[Q],Y={class:"col-6"},Z=["onClick"],x=s("i",{class:"bi bi-trash3"},null,-1),ss=[x],os=s("div",{class:"col-1"},null,-1),es={class:"modal fade",id:"addSponsor",tabindex:"-1",role:"dialog","aria-labelledby":"addSponsorLabel","aria-hidden":"true"},ts={class:"modal-dialog",role:"document"},as={class:"modal-content"},ns=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"addSponsorLabel"}," Buat Event Baru "),s("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[s("span",{"aria-hidden":"true"},"×")])],-1),rs={class:"modal-body"},is={class:"mb-3"},ls=s("label",{for:"ketua",class:"form-label"},"Pemberi Sponsor",-1),ds={class:"mb-3"},ps=s("label",{for:"ketua",class:"form-label"},"Dana Sponsor",-1),cs={class:"mb-3"},us=s("label",{for:"mission",class:"form-label"},"Events",-1),ms=s("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),hs=["value"],_s={class:"mb-3"},bs=s("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),fs={class:"modal-footer"},Ss=s("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),ks={class:"modal fade",id:"editTransaksi",tabindex:"-1",role:"dialog","aria-labelledby":"editTransaksiLabel","aria-hidden":"true"},vs={class:"modal-dialog",role:"document"},gs={class:"modal-content"},ys=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editTransaksiLabel"},"Edit Pengeluaran"),s("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[s("span",{"aria-hidden":"true"},"×")])],-1),Ds={class:"modal-body"},ws={class:"mb-3"},Us=s("label",{for:"ketua",class:"form-label"},"Pemberi Sponsor",-1),Bs={class:"mb-3"},Cs=s("label",{for:"ketua",class:"form-label"},"Dana Sponsor",-1),As={class:"mb-3"},Ts=s("label",{for:"mission",class:"form-label"},"Events",-1),Vs=s("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),$s=["value"],Es={class:"mb-3"},Is=s("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),Fs={class:"modal-footer"},Ns=s("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);y.use(E);const Ps={data(){return{sponsors:[],events:[],formSponsor:{pemberi_sponsor:"",dana_sponsor:"",deskripsi_sponsor:""},formUpdateSponsor:{pemberi_sponsor:"",dana_sponsor:"",deskripsi_sponsor:"",id_sponsor:""},ready:!1,selectedEvent:"",user_id:""}},methods:{setDataUpdate(e,a,r,u){this.formUpdateSponsor.pemberi_sponsor=e,this.formUpdateSponsor.dana_sponsor=a,this.formUpdateSponsor.deskripsi_sponsor=r,this.formUpdateSponsor.id_sponsor=u},createSponsor(){this.ready=!1;const e=new FormData;e.append("pemberi_sponsor",this.formSponsor.pemberi_sponsor),e.append("dana_sponsor",this.formSponsor.dana_sponsor),e.append("deskripsi_sponsor",this.formSponsor.deskripsi_sponsor),e.append("id_event",this.selectedEvent),m.post("https://backend.keuanganfpti.com/api/create-sponsor",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(a=>{console.log(a.data),this.formSponsor={pemberi_sponsor:"",dana_sponsor:"",deskripsi_sponsor:"",selectedEvent:""},this.showAlert("Request Success","Sponsor berhasil buat","success"),this.fetchDataSponsor()}).catch(a=>{this.showAlert("Request Failed","Sponsor gagal buat","error"),console.error(a),this.ready=!0})},updateSponsor(){this.ready=!1;const e=new FormData;e.append("pemberi_sponsor",this.formUpdateSponsor.pemberi_sponsor),e.append("dana_sponsor",this.formUpdateSponsor.dana_sponsor),e.append("deskripsi_sponsor",this.formUpdateSponsor.deskripsi_sponsor),e.append("id_event",this.selectedEvent),m.post(`https://backend.keuanganfpti.com/api/update-sponsor/${this.formUpdateSponsor.id_sponsor}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(a=>{console.log(a.data),this.showAlert("Request Success","Sponsor berhasil diupdate","success"),this.fetchDataSponsor()}).catch(a=>{this.showAlert("Request Failed","Sponsor gagal diupdate","error"),console.error(a),this.ready=!0})},deleteSponsor(e){this.ready=!1,m.delete(`https://backend.keuanganfpti.com/api/delete-sponsor/${e}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(a=>{console.log(a.data),this.showAlert("Request Success","Sponsor berhasil dihapus","success"),this.fetchDataSponsor()}).catch(a=>{this.showAlert("Request Failed","Sponsor gagal dihapus","error"),console.error(a),this.ready=!0})},async fetchDataSponsor(){try{const e=await m.get("https://backend.keuanganfpti.com/api/list-sponsor",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.sponsors=e.data.data,this.ready=!0}catch(e){this.ready=!0,console.error(e)}},async fetchDataActiveEvent(){try{const e=await m.get("https://backend.keuanganfpti.com/api/event-active",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.events=e.data.data}catch(e){console.error(e)}},showAlert(e,a,r){this.$swal({title:e,text:a,icon:r}).then(()=>{$("#addSponsor").modal("hide"),$("#editTransaksi").modal("hide")})},konfirmasi(e,a){I.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus sponsor dari ${a}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(r=>{r.isConfirmed&&this.deleteSponsor(e)})}},computed:{formatCurrency:function(){return function(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp 0,00"}}},created(){const e=sessionStorage.getItem("token");if(e)try{const[a,r]=e.split("."),u=JSON.parse(atob(a)),t=atob(r),n=JSON.parse(atob(e.split(".")[1])),o=n.exp,h=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",h.toUTCString()),new Date>h?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const b=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),b!=="1"?this.$router.push("/unauthorized"):(!u||!t)&&this.$router.push("/"),this.fetchDataSponsor(),this.fetchDataActiveEvent()}catch(a){console.error("Error decoding token:",a),this.$router.push("/")}else this.$router.push("/")}},Js=Object.assign(Ps,{__name:"Sponsor",setup(e){const a=k(!1),r=k(""),u=()=>{a.value=!a.value,r.value=a.value?"toggle-sidebar":""};return(t,n)=>(i(),l(_,null,[s("div",F,[f(A,{class:D(r.value)},null,8,["class"]),s("div",N,[s("div",P,[f(T,{onToggleSidebar:u}),s("div",R,[q,s("div",z,[L,s("div",K,[J,s("div",O,[t.ready?v("",!0):(i(),l("p",j,"Loading...")),t.ready?(i(),w(B(y),{key:1,class:"display table table-striped"},{default:U(()=>[H,s("tbody",null,[(i(!0),l(_,null,S(t.sponsors,(o,h)=>(i(),l("tr",{key:o.id},[s("td",null,p(h+1),1),s("td",null,[s("div",M,[s("div",G,[s("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editTransaksi",onClick:b=>t.setDataUpdate(o.pemberi_sponsor,o.dana_sponsor,o.deskripsi_sponsor,o.id)},X,8,W)]),s("div",Y,[s("button",{onClick:b=>t.konfirmasi(o.id,o.pemberi_sponsor),class:"btn btn-danger customDetail"},ss,8,Z)])])]),s("td",null,p(o.pemberi_sponsor),1),s("td",null,p(t.formatCurrency(o.dana_sponsor)),1),s("td",null,p(o.deskripsi_sponsor),1)]))),128))])]),_:1})):v("",!0)])]),os])])]),f(V)])]),s("div",es,[s("div",ts,[s("div",as,[ns,s("div",rs,[s("form",null,[s("div",is,[ls,d(s("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan pemberi sponsor","onUpdate:modelValue":n[0]||(n[0]=o=>t.formSponsor.pemberi_sponsor=o)},null,512),[[c,t.formSponsor.pemberi_sponsor]])]),s("div",ds,[ps,d(s("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan dana sponsor","onUpdate:modelValue":n[1]||(n[1]=o=>t.formSponsor.dana_sponsor=o)},null,512),[[c,t.formSponsor.dana_sponsor]])]),s("div",cs,[us,d(s("select",{class:"form-select","onUpdate:modelValue":n[2]||(n[2]=o=>t.selectedEvent=o)},[ms,(i(!0),l(_,null,S(t.events,o=>(i(),l("option",{key:o.id,value:o.id},p(o.nama_event)+" - "+p(o.tanggal_event),9,hs))),128))],512),[[g,t.selectedEvent]])]),s("div",_s,[bs,d(s("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":n[3]||(n[3]=o=>t.formSponsor.deskripsi_sponsor=o)},null,512),[[c,t.formSponsor.deskripsi_sponsor]])])])]),s("div",fs,[Ss,s("button",{type:"button",class:"btn blueButton",onClick:n[4]||(n[4]=(...o)=>t.createSponsor&&t.createSponsor(...o))}," Simpan ")])])])]),s("div",ks,[s("div",vs,[s("div",gs,[ys,s("div",Ds,[s("form",null,[s("div",ws,[Us,d(s("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan pemberi sponsor","onUpdate:modelValue":n[5]||(n[5]=o=>t.formUpdateSponsor.pemberi_sponsor=o)},null,512),[[c,t.formUpdateSponsor.pemberi_sponsor]])]),s("div",Bs,[Cs,d(s("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan dana sponsor","onUpdate:modelValue":n[6]||(n[6]=o=>t.formUpdateSponsor.dana_sponsor=o)},null,512),[[c,t.formUpdateSponsor.dana_sponsor]])]),s("div",As,[Ts,d(s("select",{class:"form-select","onUpdate:modelValue":n[7]||(n[7]=o=>t.selectedEvent=o)},[Vs,(i(!0),l(_,null,S(t.events,o=>(i(),l("option",{key:o.id,value:o.id},p(o.nama_event)+" - "+p(o.tanggal_event),9,$s))),128))],512),[[g,t.selectedEvent]])]),s("div",Es,[Is,d(s("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":n[8]||(n[8]=o=>t.formUpdateSponsor.deskripsi_sponsor=o)},null,512),[[c,t.formUpdateSponsor.deskripsi_sponsor]])])])]),s("div",Fs,[Ns,s("button",{type:"button",class:"btn blueButton",onClick:n[9]||(n[9]=(...o)=>t.updateSponsor&&t.updateSponsor(...o))}," Simpan ")])])])])],64))}});export{Js as default};
