import{r as k,b as r,f as i,g as e,i as b,n as B,l as v,c as S,G as w,J as U,j as d,v as p,L as y,F as _,H as f,K as D,I as u}from"./index-c4c3c49d.js";import{S as C,N as j,F as A}from"./Footer-48849b32.js";import{P,D as T}from"./TimeVote-c8e460eb.js";import{a as h}from"./_commonjsHelpers-34c3cec1.js";import{S as V}from"./sweetalert2.all-777e80f8.js";const F={id:"wrapper"},E={id:"content-wrapper",class:"d-flex flex-column"},I={id:"content"},N={class:"container-fluid mt-4"},L=e("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," Data Pengeluaran ",-1),R={class:"row"},K=e("div",{class:"col-1"},null,-1),q={class:"col-10"},z=D('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addPengeluaran"><i class="bi bi-plus-circle-fill"></i> Buat Pengeluaran </button></div><div class="col-6"></div></div>',1),J={class:"table-responsive"},M={key:0,class:"text-center"},O=e("thead",null,[e("tr",null,[e("th",{scope:"col",style:{width:"50px"}},"No"),e("th",{scope:"col"},"Aksi"),e("th",{scope:"col"},"Kebutuhan"),e("th",{scope:"col"},"Jumlah Pengeluaranr"),e("th",{scope:"col"},"Deskripsi Pengeluaran"),e("th",{scope:"col"},"Bukti Pengeluaran")])],-1),H={class:"row"},G={class:"col-6"},W=["onClick"],Q=e("i",{class:"bi bi-pencil-square"},null,-1),X=[Q],Y={class:"col-6"},Z=["onClick"],x=e("i",{class:"bi bi-trash3"},null,-1),ee=[x],ae=["src","onClick"],te=e("div",{class:"col-1"},null,-1),ne={class:"modal fade",id:"addPengeluaran",tabindex:"-1",role:"dialog","aria-labelledby":"addPengeluaranLabel","aria-hidden":"true"},se={class:"modal-dialog",role:"document"},le={class:"modal-content"},oe=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addPengeluaranLabel"}," Buat Event Baru "),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),re={class:"modal-body"},ie={class:"mb-3"},de=e("label",{for:"kebu",class:"form-label"},"Kebutuhan",-1),ue={class:"mb-3"},pe=e("label",{for:"jumpe",class:"form-label"},"Jumlah Pengeluaran",-1),ce={class:"mb-3"},he=e("label",{for:"mission",class:"form-label"},"Events",-1),ge=e("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),me=["value"],_e={class:"mb-3"},be=e("label",{for:"bukti_pengeluaran",class:"form-label"},"Bukti Pengeluaran",-1),fe={class:"mb-3"},ke=e("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),ve={class:"modal-footer"},ye=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),Pe={class:"modal fade",id:"editPengeluaran",tabindex:"-1",role:"dialog","aria-labelledby":"editPengeluaranLabel","aria-hidden":"true"},Be={class:"modal-dialog",role:"document"},Se={class:"modal-content"},we=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"editPengeluaranLabel"},"Edit Pengeluaran"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),Ue={class:"modal-body"},De={class:"mb-3"},Ce=e("label",{for:"ketua",class:"form-label"},"Kebutuhan",-1),je={class:"mb-3"},Ae=e("label",{for:"ketua",class:"form-label"},"Jumlah Pengeluaran",-1),$e={class:"mb-3"},Te=e("label",{for:"mission",class:"form-label"},"Events",-1),Ve=e("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),Fe=["value"],Ee={class:"mb-3"},Ie=e("label",{for:"keterangan",class:"form-label"},"Deskripsi",-1),Ne={class:"modal-footer"},Le=e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),Re={class:"modal fade",id:"detailBukti",tabindex:"-1",role:"dialog","aria-labelledby":"detailBuktiLabel","aria-hidden":"true",ref:"detailBuktiRef"},Ke={class:"modal-dialog",role:"document"},qe={class:"modal-content"},ze=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addInvoiceModalLabel"}," Detail Bukti Keterangan "),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1),Je={class:"modal-body"},Me=["src"],Oe=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close ")],-1);P.use(T);const He={data(){return{pengeluarans:[],events:[],formPengeluaran:{keperluan_pengeluaran:"",jumlah_pengeluaran:"",deskripsi_pengeluaran:"",bukti_pengeluaran:null},formUpdatePengeluaran:{keperluan_pengeluaran:"",jumlah_pengeluaran:"",deskripsi_pengeluaran:"",bukti_pengeluaran:null,id_pengeluaran:""},ready:!1,selectedEvent:"",user_id:"",path:""}},methods:{detailBukti(t){this.path=t,$("#detailBukti").modal("show")},setDataUpdate(t,s,o,c){this.formUpdatePengeluaran.keperluan_pengeluaran=t,this.formUpdatePengeluaran.jumlah_pengeluaran=s,this.formUpdatePengeluaran.deskripsi_pengeluaran=o,this.formUpdatePengeluaran.id_pengeluaran=c},createPengeluaran(){this.ready=!1;const t=new FormData;t.append("keperluan_pengeluaran",this.formPengeluaran.keperluan_pengeluaran),t.append("jumlah_pengeluaran",this.formPengeluaran.jumlah_pengeluaran),t.append("deskripsi_pengeluaran",this.formPengeluaran.deskripsi_pengeluaran),t.append("bukti_pengeluaran",this.formPengeluaran.bukti_pengeluaran),t.append("id_event",this.selectedEvent),h.post("https://backend.keuanganfpti.com/api/create-pengeluaran",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.formPengeluaran={pemberi_sponsor:"",dana_sponsor:"",deskripsi_sponsor:"",selectedEvent:""},this.showAlert("Request Success","Sponsor berhasil buat","success"),this.fetchDataSponsor()}).catch(s=>{this.showAlert("Request Failed","Sponsor gagal buat","error"),console.error(s),this.ready=!0})},updatePengeluaran(){this.ready=!1;const t=new FormData;t.append("keperluan_pengeluaran",this.formUpdatePengeluaran.keperluan_pengeluaran),t.append("jumlah_pengeluaran",this.formUpdatePengeluaran.jumlah_pengeluaran),t.append("deskripsi_pengeluaran",this.formUpdatePengeluaran.deskripsi_pengeluaran),t.append("id_event",this.selectedEvent),h.post(`https://backend.keuanganfpti.com/api/update-pengeluaran/${this.formUpdatePengeluaran.id_pengeluaran}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.showAlert("Request Success","Sponsor berhasil diupdate","success"),this.fetchDataSponsor()}).catch(s=>{this.showAlert("Request Failed","Sponsor gagal diupdate","error"),console.error(s),this.ready=!0})},deletePengeluaran(t){this.ready=!1,h.delete(`https://backend.keuanganfpti.com/api/delete-pengeluaran/${t}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.showAlert("Request Success","Sponsor berhasil dihapus","success"),this.fetchDataSponsor()}).catch(s=>{this.showAlert("Request Failed","Sponsor gagal dihapus","error"),console.error(s),this.ready=!0})},async fetchDataSponsor(){try{const t=await h.get("https://backend.keuanganfpti.com/api/list-pengeluaran",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.pengeluarans=t.data.data,this.ready=!0}catch(t){this.ready=!0,console.error(t)}},async fetchDataActiveEvent(){try{const t=await h.get("https://backend.keuanganfpti.com/api/event-active",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.events=t.data.data}catch(t){console.error(t)}},showAlert(t,s,o){this.$swal({title:t,text:s,icon:o}).then(()=>{$("#addPengeluaran").modal("hide"),$("#editPengeluaran").modal("hide")})},konfirmasi(t,s){V.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus pengeluaran ${s}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(o=>{o.isConfirmed&&this.deletePengeluaran(t)})},handleFileUpload(t){this.formPengeluaran.bukti_pengeluaran=t.target.files[0]}},computed:{formatCurrency:function(){return function(t){return t?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t):"Rp 0,00"}}},created(){const t=sessionStorage.getItem("token");if(t)try{const[s,o]=t.split("."),c=JSON.parse(atob(s)),n=atob(o),l=JSON.parse(atob(t.split(".")[1])),a=l.exp,g=new Date(a*1e3);console.log("Waktu Kedaluwarsa (UTC):",g.toUTCString()),new Date>g?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const m=l.level;this.user_id=l.id,console.log("ini idddd:",this.user_id),m!=="1"?this.$router.push("/unauthorized"):(!c||!n)&&this.$router.push("/"),this.fetchDataSponsor(),this.fetchDataActiveEvent()}catch(s){console.error("Error decoding token:",s),this.$router.push("/")}else this.$router.push("/")}},Ze=Object.assign(He,{__name:"Pengeluaran",setup(t){const s=k(!1),o=k(""),c=()=>{s.value=!s.value,o.value=s.value?"toggle-sidebar":""};return(n,l)=>(r(),i(_,null,[e("div",F,[b(C,{class:B(o.value)},null,8,["class"]),e("div",E,[e("div",I,[b(j,{onToggleSidebar:c}),e("div",N,[L,e("div",R,[K,e("div",q,[z,e("div",J,[n.ready?v("",!0):(r(),i("p",M,"Loading...")),n.ready?(r(),S(U(P),{key:1,class:"display table table-striped"},{default:w(()=>[O,e("tbody",null,[(r(!0),i(_,null,f(n.pengeluarans,(a,g)=>(r(),i("tr",{key:a.id},[e("td",null,u(g+1),1),e("td",null,[e("div",H,[e("div",G,[e("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#editPengeluaran",onClick:m=>n.setDataUpdate(a.keperluan_pengeluaran,a.jumlah_pengeluaran,a.deskripsi_pengeluaran,a.id)},X,8,W)]),e("div",Y,[e("button",{onClick:m=>n.konfirmasi(a.id,a.keperluan_pengeluaran),class:"btn btn-danger customDetail"},ee,8,Z)])])]),e("td",null,u(a.keperluan_pengeluaran),1),e("td",null,u(a.jumlah_pengeluaran),1),e("td",null,u(a.deskripsi_pengeluaran),1),e("td",null,[e("img",{src:"https://backend.keuanganfpti.com/storage/"+a.bukti_pengeluaran,alt:"Bukti Transfer",style:{"max-width":"100px",cursor:"pointer"},onClick:m=>n.detailBukti(a.bukti_pengeluaran)},null,8,ae)])]))),128))])]),_:1})):v("",!0)])]),te])])]),b(A)])]),e("div",ne,[e("div",se,[e("div",le,[oe,e("div",re,[e("form",null,[e("div",ie,[de,d(e("input",{type:"text",class:"form-control",id:"kebu",placeholder:"masukkan kebutuhan","onUpdate:modelValue":l[0]||(l[0]=a=>n.formPengeluaran.keperluan_pengeluaran=a)},null,512),[[p,n.formPengeluaran.keperluan_pengeluaran]])]),e("div",ue,[pe,d(e("input",{type:"text",class:"form-control",id:"jumpe",placeholder:"masukkan jumlah pengeluaran","onUpdate:modelValue":l[1]||(l[1]=a=>n.formPengeluaran.jumlah_pengeluaran=a)},null,512),[[p,n.formPengeluaran.jumlah_pengeluaran]])]),e("div",ce,[he,d(e("select",{class:"form-select","onUpdate:modelValue":l[2]||(l[2]=a=>n.selectedEvent=a)},[ge,(r(!0),i(_,null,f(n.events,a=>(r(),i("option",{key:a.id,value:a.id},u(a.nama_event)+" - "+u(a.tanggal_event),9,me))),128))],512),[[y,n.selectedEvent]])]),e("div",_e,[be,e("input",{type:"file",class:"form-control",id:"bukti_pengeluaran",onChange:l[3]||(l[3]=(...a)=>n.handleFileUpload&&n.handleFileUpload(...a))},null,32)]),e("div",fe,[ke,d(e("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":l[4]||(l[4]=a=>n.formPengeluaran.deskripsi_pengeluaran=a)},null,512),[[p,n.formPengeluaran.deskripsi_pengeluaran]])])])]),e("div",ve,[ye,e("button",{type:"button",class:"btn blueButton",onClick:l[5]||(l[5]=(...a)=>n.createPengeluaran&&n.createPengeluaran(...a))}," Simpan ")])])])]),e("div",Pe,[e("div",Be,[e("div",Se,[we,e("div",Ue,[e("form",null,[e("div",De,[Ce,d(e("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan kebutuhan","onUpdate:modelValue":l[6]||(l[6]=a=>n.formUpdatePengeluaran.keperluan_pengeluaran=a)},null,512),[[p,n.formUpdatePengeluaran.keperluan_pengeluaran]])]),e("div",je,[Ae,d(e("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan jumlah pengeluaran","onUpdate:modelValue":l[7]||(l[7]=a=>n.formUpdatePengeluaran.jumlah_pengeluaran=a)},null,512),[[p,n.formUpdatePengeluaran.jumlah_pengeluaran]])]),e("div",$e,[Te,d(e("select",{class:"form-select","onUpdate:modelValue":l[8]||(l[8]=a=>n.selectedEvent=a)},[Ve,(r(!0),i(_,null,f(n.events,a=>(r(),i("option",{key:a.id,value:a.id},u(a.nama_event)+" - "+u(a.tanggal_event),9,Fe))),128))],512),[[y,n.selectedEvent]])]),e("div",Ee,[Ie,d(e("textarea",{class:"form-control",id:"keterangan",placeholder:"masukkan deskripsi","onUpdate:modelValue":l[9]||(l[9]=a=>n.formUpdatePengeluaran.deskripsi_pengeluaran=a)},null,512),[[p,n.formUpdatePengeluaran.deskripsi_pengeluaran]])])])]),e("div",Ne,[Le,e("button",{type:"button",class:"btn blueButton",onClick:l[10]||(l[10]=(...a)=>n.updatePengeluaran&&n.updatePengeluaran(...a))}," Simpan ")])])])]),e("div",Re,[e("div",Ke,[e("div",qe,[ze,e("div",Je,[e("img",{src:"https://backend.keuanganfpti.com/storage/"+n.path,alt:"Bukti Transfer",style:{width:"100%"}},null,8,Me),Oe])])])],512)],64))}});export{Ze as default};
