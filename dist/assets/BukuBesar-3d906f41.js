import{S as k}from"./Sidebar-192cc78b.js";import{N as y,F as B}from"./Footer-3c1305de.js";import{a as c,S as b}from"./sweetalert2.all-1e3fb24f.js";import{P as _,D as w}from"./jquery.dataTables-f52bf5d6.js";import{r as m,b as n,f as d,i as p,n as S,g as t,l as f,c as v,z as M,A as C,F as D,B as A,C as l}from"./index-6a3474be.js";const T={id:"wrapper"},x={id:"content-wrapper",class:"d-flex flex-column"},F={id:"content"},I={class:"container-fluid mt-4"},N=t("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"},"Buku Besar",-1),j={class:"row"},R=t("div",{class:"col-1"},null,-1),z={class:"col-10"},q={class:"table-responsive"},U={key:0,class:"text-center"},V=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"No"),t("th",{scope:"col"},"Akun"),t("th",{scope:"col"},"Total Debit"),t("th",{scope:"col"},"Total Kredit"),t("th",{scope:"col"},"Total Hutang"),t("th",{scope:"col"},"Saldo Sekarang")])],-1),K=t("div",{class:"col-1"},null,-1);_.use(w);const O={data(){return{bukuBesar:[],formMapel:{nama_mapel:""},formUpdateMapel:{nama_mapel:""},ready:!1,mapel_id:""}},methods:{createMapel(){this.ready=!1;const a=new FormData;a.append("nama_mapel",this.formMapel.nama_mapel),c.post("http://localhost:8000/api/create-mapel",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil buat","success"),this.fetchDataBukuBesar()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal buat","error"),console.error(e),this.ready=!0})},updateMapel(){this.ready=!1;const a=new FormData;a.append("nama_mapel",this.formUpdateMapel.nama_mapel),c.post(`http://localhost:8000/api/update-mapel/${this.mapel_id}`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil diupdate","success"),this.fetchDataBukuBesar()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal diupdate","error"),console.error(e),this.ready=!0})},deleteMapel(a){this.ready=!1,c.delete(`http://localhost:8000/api/delete-mapel/${a}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.showAlert("Request Success","Matapelajaran berhasil dihapus","success"),this.fetchDataBukuBesar()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal dihapus","error"),console.error(e),this.ready=!0})},async fetchDataBukuBesar(){try{const a=await c.get("https://backend.keuanganfpti.com/api/buku-besar",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.bukuBesar=a.data.data,this.ready=!0}catch(a){this.ready=!0,console.error(a)}},showAlert(a,e,o){this.$swal({title:a,text:e,icon:o}).then(()=>{$("#addMapel").modal("hide"),$("#editMapel").modal("hide")})},konfirmasi(a,e){b.fire({title:`Apakah Anda yakin ingin menghapus matapelajaran ${e}?`,text:"Anda akan keluar dari akun ini.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(o=>{o.isConfirmed&&this.deleteMapel(a)})},setMapelId(a,e){this.mapel_id=a,this.formUpdateMapel.nama_mapel=e}},computed:{formatCurrency:function(){return function(a){return a?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a):"Rp 0,00"}}},created(){const a=sessionStorage.getItem("token");if(a)try{const[e,o]=a.split("."),h=JSON.parse(atob(e)),s=atob(o),i=JSON.parse(atob(a.split(".")[1])),r=i.exp,u=new Date(r*1e3);console.log("Waktu Kedaluwarsa (UTC):",u.toUTCString()),new Date>u?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const g=i.level;this.user_id=i.id,console.log("ini idddd:",this.user_id),g!=="0"?this.$router.push("/unauthorized"):(!h||!s)&&this.$router.push("/"),this.fetchDataBukuBesar()}catch(e){console.error("Error decoding token:",e),this.$router.push("/")}else this.$router.push("/")}},W=Object.assign(O,{__name:"BukuBesar",setup(a){const e=m(!1),o=m(""),h=()=>{e.value=!e.value,o.value=e.value?"toggle-sidebar":""};return(s,i)=>(n(),d("div",T,[p(k,{class:S(o.value)},null,8,["class"]),t("div",x,[t("div",F,[p(y,{onToggleSidebar:h}),t("div",I,[N,t("div",j,[R,t("div",z,[t("div",q,[s.ready?f("",!0):(n(),d("p",U,"Loading...")),s.ready?(n(),v(C(_),{key:1,class:"display table table-striped"},{default:M(()=>[V,t("tbody",null,[(n(!0),d(D,null,A(s.bukuBesar,(r,u)=>(n(),d("tr",{key:r.id},[t("td",null,l(u+1),1),t("td",null,l(r.name),1),t("td",null,l(s.formatCurrency(r.total_pengeluaran)),1),t("td",null,l(s.formatCurrency(r.total_pemasukan)),1),t("td",null,l(s.formatCurrency(r.total_hutang)),1),t("td",null,l(s.formatCurrency(r.saldo)),1)]))),128))])]),_:1})):f("",!0)])]),K])])]),p(B)])]))}});export{W as default};
