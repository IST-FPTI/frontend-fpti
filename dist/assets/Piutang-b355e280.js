import{r as h,b as i,f as c,g as a,i as u,n as y,l as _,c as M,z as w,A as S,j as b,v as f,F as g,y as B,B as C,C as r}from"./index-c01b12d4.js";import{S as A}from"./Sidebar-0d63748e.js";import"./TimeVote-ea42eaf2.js";import{N as D,F as j}from"./Footer-8f41188f.js";import{a as p,S as T}from"./sweetalert2.all-1e3fb24f.js";import{P as k,D as x}from"./jquery.dataTables-31a7655e.js";const P={id:"wrapper"},N={id:"content-wrapper",class:"d-flex flex-column"},F={id:"content"},U={class:"container-fluid mt-4"},I=a("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"},"List Piutang",-1),z={class:"row"},L=a("div",{class:"col-1"},null,-1),q={class:"col-10"},R=B('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addMapel"><i class="bi bi-plus-circle-fill"></i> Ajukan </button></div><div class="col-6"></div></div>',1),V={class:"table-responsive"},E={key:0,class:"text-center"},K=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col"},"Nominal"),a("th",{scope:"col"},"Keterangan"),a("th",{scope:"col"},"Tanggal Masuk"),a("th",{scope:"col"},"Pengirim")])],-1),O=a("div",{class:"col-1"},null,-1),J={class:"modal fade",id:"addMapel",tabindex:"-1",role:"dialog","aria-labelledby":"addMapelLabel","aria-hidden":"true"},H={class:"modal-dialog",role:"document"},W={class:"modal-content"},G=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"addMapelLabel"},"Input Matapelajaran"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),Q={class:"modal-body"},X={class:"mb-3"},Y=a("label",{for:"ketua",class:"form-label"},"Matapelajaran",-1),Z={class:"modal-footer"},aa=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),ea={class:"modal fade",id:"editMapel",tabindex:"-1",role:"dialog","aria-labelledby":"editMapelLabel","aria-hidden":"true"},ta={class:"modal-dialog",role:"document"},sa={class:"modal-content"},oa=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"editMapelLabel"},"Edit Matapelajaran"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),la={class:"modal-body"},na={class:"mb-3"},ia=a("label",{for:"ketua",class:"form-label"},"Matapelajaran",-1),ra={class:"modal-footer"},da=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);k.use(x);const ca={data(){return{pemasukan:[],formMapel:{nama_mapel:""},formUpdateMapel:{nama_mapel:""},ready:!1,mapel_id:""}},methods:{createMapel(){this.ready=!1;const t=new FormData;t.append("nama_mapel",this.formMapel.nama_mapel),p.post("http://localhost:8000/api/create-mapel",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil buat","success"),this.fetchDataPemasukan()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal buat","error"),console.error(e),this.ready=!0})},updateMapel(){this.ready=!1;const t=new FormData;t.append("nama_mapel",this.formUpdateMapel.nama_mapel),p.post(`http://localhost:8000/api/update-mapel/${this.mapel_id}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.formMapel={nama_mapel:""},this.showAlert("Request Success","Matapelajaran berhasil diupdate","success"),this.fetchDataPemasukan()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal diupdate","error"),console.error(e),this.ready=!0})},deleteMapel(t){this.ready=!1,p.delete(`http://localhost:8000/api/delete-mapel/${t}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(e=>{console.log(e.data),this.showAlert("Request Success","Matapelajaran berhasil dihapus","success"),this.fetchDataPemasukan()}).catch(e=>{this.showAlert("Request Failed","Matapelajaran gagal dihapus","error"),console.error(e),this.ready=!0})},async fetchDataPemasukan(){try{const t=await p.get("http://localhost:8000/api/list-pemasukan/2",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.pemasukan=t.data.data,this.ready=!0}catch(t){console.error(t)}},showAlert(t,e,n){this.$swal({title:t,text:e,icon:n}).then(()=>{$("#addMapel").modal("hide"),$("#editMapel").modal("hide")})},konfirmasi(t,e){T.fire({title:`Apakah Anda yakin ingin menghapus matapelajaran ${e}?`,text:"Anda akan keluar dari akun ini.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&this.deleteMapel(t)})},setMapelId(t,e){this.mapel_id=t,this.formUpdateMapel.nama_mapel=e}},created(){const t=sessionStorage.getItem("token");if(t)try{const[e,n]=t.split("."),m=JSON.parse(atob(e)),o=atob(n),l=JSON.parse(atob(t.split(".")[1])),s=l.exp,d=new Date(s*1e3);console.log("Waktu Kedaluwarsa (UTC):",d.toUTCString()),new Date>d?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const v=l.level;this.user_id=l.id,console.log("ini idddd:",this.user_id),v!=="1"?this.$router.push("/unauthorized"):(!m||!o)&&this.$router.push("/"),this.fetchDataPemasukan()}catch(e){console.error("Error decoding token:",e),this.$router.push("/")}else this.$router.push("/")}},fa=Object.assign(ca,{__name:"Piutang",setup(t){const e=h(!1),n=h(""),m=()=>{e.value=!e.value,n.value=e.value?"toggle-sidebar":""};return(o,l)=>(i(),c(g,null,[a("div",P,[u(A,{class:y(n.value)},null,8,["class"]),a("div",N,[a("div",F,[u(D,{onToggleSidebar:m}),a("div",U,[I,a("div",z,[L,a("div",q,[R,a("div",V,[o.ready?_("",!0):(i(),c("p",E,"Loading...")),o.ready?(i(),M(S(k),{key:1,class:"display table table-striped"},{default:w(()=>[K,a("tbody",null,[(i(!0),c(g,null,C(o.pemasukan,(s,d)=>(i(),c("tr",{key:s.id},[a("td",null,r(d+1),1),a("td",null,r(s.jumlah_transaksi),1),a("td",null,r(s.deskripsi),1),a("td",null,r(s.tgl_transaksi),1),a("td",null,r(s.nama_pengirim),1)]))),128))])]),_:1})):_("",!0)])]),O])])]),u(j)])]),a("div",J,[a("div",H,[a("div",W,[G,a("div",Q,[a("form",null,[a("div",X,[Y,b(a("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan nama mapel","onUpdate:modelValue":l[0]||(l[0]=s=>o.formMapel.nama_mapel=s)},null,512),[[f,o.formMapel.nama_mapel]])])])]),a("div",Z,[aa,a("button",{type:"button",class:"btn blueButton",onClick:l[1]||(l[1]=(...s)=>o.createMapel&&o.createMapel(...s))}," Simpan ")])])])]),a("div",ea,[a("div",ta,[a("div",sa,[oa,a("div",la,[a("form",null,[a("div",na,[ia,b(a("input",{type:"text",class:"form-control",id:"mapel",placeholder:"masukkan nama mapel","onUpdate:modelValue":l[2]||(l[2]=s=>o.formUpdateMapel.nama_mapel=s)},null,512),[[f,o.formUpdateMapel.nama_mapel]])])])]),a("div",ra,[da,a("button",{type:"button",class:"btn blueButton",onClick:l[3]||(l[3]=(...s)=>o.updateMapel&&o.updateMapel(...s))}," Simpan ")])])])])],64))}});export{fa as default};
