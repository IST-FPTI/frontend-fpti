import{r as k,b as r,f as u,g as a,i as f,n as y,l as v,c as U,G as w,K as D,j as l,v as p,L as P,F as g,H as b,J as S,I as d}from"./index-f08a5f4b.js";import{S as B,N as C,F as A}from"./Footer-58f90b1d.js";import{P as j,D as V}from"./TimeVote-880eba30.js";import{a as c}from"./_commonjsHelpers-34c3cec1.js";import{S as N}from"./sweetalert2.all-777e80f8.js";const T={id:"wrapper"},E={id:"content-wrapper",class:"d-flex flex-column"},I={id:"content"},F={class:"container-fluid mt-4"},H=a("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," Data Piutang ",-1),J={class:"row"},R=a("div",{class:"col-1"},null,-1),q={class:"col-10"},z=S('<div class="row mb-3"><div class="col-6"><button class="btn btn-warning me-2" data-toggle="modal" data-target="#addPiutang"><i class="bi bi-plus-circle-fill"></i> Buat Piutang </button></div><div class="col-6"></div></div>',1),L={class:"table-responsive"},K={key:0,class:"text-center"},M=a("thead",null,[a("tr",null,[a("th",{scope:"col",style:{width:"50px"}},"No"),a("th",{scope:"col"},"Aksi"),a("th",{scope:"col"},"Peminjam"),a("th",{scope:"col"},"No Hp"),a("th",{scope:"col"},"Jumlah Pinjaman"),a("th",{scope:"col"},"Deskripsi Pinjaman"),a("th",{scope:"col"},"Status")])],-1),O={class:"row"},G={class:"col-6"},W=["onClick"],Q=a("i",{class:"bi bi-pencil-square"},null,-1),X=[Q],Y={class:"col-6"},Z=["onClick"],x=a("i",{class:"bi bi-trash3"},null,-1),aa=[x],ta=a("div",{class:"col-1"},null,-1),ea={class:"modal fade",id:"addPiutang",tabindex:"-1",role:"dialog","aria-labelledby":"addPiutangLabel","aria-hidden":"true"},sa={class:"modal-dialog",role:"document"},na={class:"modal-content"},oa=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"addPiutangLabel"}," Buat Piutang "),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),ia={class:"modal-body"},la={class:"mb-3"},da=a("label",{for:"ketua",class:"form-label"},"Peminjam",-1),ra={class:"mb-3"},ua=a("label",{for:"ketua",class:"form-label"},"Nomor HP",-1),pa={class:"mb-3"},ma=a("label",{for:"ketua",class:"form-label"},"Jumlah Pinjaman",-1),ca={class:"mb-3"},ha=a("label",{for:"mission",class:"form-label"},"Events",-1),ga=a("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),_a=["value"],fa={class:"mb-3"},ba=a("label",{for:"keterangan",class:"form-label"},"Deskripsi Pinjaman",-1),ka={class:"modal-footer"},va=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1),Pa={class:"modal fade",id:"aditPiutang",tabindex:"-1",role:"dialog","aria-labelledby":"aditPiutangLabel","aria-hidden":"true"},ja={class:"modal-dialog",role:"document"},ya={class:"modal-content"},Ua=a("div",{class:"modal-header"},[a("h5",{class:"modal-title",id:"aditPiutangLabel"},"Edit Hutang"),a("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},"×")])],-1),wa={class:"modal-body"},Da={class:"mb-3"},Sa=a("label",{for:"ketua",class:"form-label"},"Peminjam",-1),Ba={class:"mb-3"},Ca=a("label",{for:"ketua",class:"form-label"},"Nomor HP",-1),Aa={class:"mb-3"},Va=a("label",{for:"ketua",class:"form-label"},"Jumlah Pinjaman",-1),Na={class:"mb-3"},$a=a("label",{for:"mission",class:"form-label"},"Events",-1),Ta=a("option",{value:"",disabled:"",selected:""},"Pilih Event",-1),Ea=["value"],Ia={class:"mb-3"},Fa=a("label",{for:"keterangan",class:"form-label"},"Deskripsi Pinjaman",-1),Ha={class:"modal-footer"},Ja=a("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal ",-1);j.use(V);const Ra={data(){return{piutangs:[],events:[],formPiutang:{pihak_peminjam:"",no_hp:"",jumlah_pinjaman:"",deskripsi_pinjaman:""},formUpdatePiutang:{pihak_peminjam:"",no_hp:"",jumlah_pinjaman:"",deskripsi_pinjaman:"",id_piutang:""},ready:!1,selectedEvent:"",user_id:""}},methods:{setDataUpdate(e,o,i,m,s){this.formUpdatePiutang.pihak_peminjam=e,this.formUpdatePiutang.no_hp=o,this.formUpdatePiutang.jumlah_pinjaman=i,this.formUpdatePiutang.deskripsi_pinjaman=m,this.formUpdatePiutang.id_piutang=s},createPiutang(){this.ready=!1;const e=new FormData;e.append("pihak_peminjam",this.formPiutang.pihak_peminjam),e.append("no_hp",this.formPiutang.no_hp),e.append("jumlah_pinjaman",this.formPiutang.jumlah_pinjaman),e.append("deskripsi_pinjaman",this.formPiutang.deskripsi_pinjaman),e.append("id_event",this.selectedEvent),c.post("https://backend.keuanganfpti.com/api/create-piutang",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.formPiutang={keperluan_hutang:"",jumlah_hutang:"",tanggal_hutang:"",tanggal_jatuh_tempo:"",deskripsi_hutang:"",selectedEvent:""},this.showAlert("Request Success","Piutang berhasil buat","success"),this.fetchDataPiutang()}).catch(o=>{this.showAlert("Request Failed","Piutang gagal buat","error"),console.error(o),this.ready=!0})},updatePiutang(){this.ready=!1;const e=new FormData;e.append("pihak_peminjam",this.formUpdatePiutang.pihak_peminjam),e.append("no_hp",this.formUpdatePiutang.no_hp),e.append("jumlah_pinjaman",this.formUpdatePiutang.jumlah_pinjaman),e.append("deskripsi_pinjaman",this.formUpdatePiutang.deskripsi_pinjaman),e.append("id_event",this.selectedEvent),c.post(`https://backend.keuanganfpti.com/api/update-piutang/${this.formUpdatePiutang.id_piutang}`,e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Piutang berhasil diupdate","success"),this.fetchDataPiutang()}).catch(o=>{this.showAlert("Request Failed","Piutang gagal diupdate","error"),console.error(o),this.ready=!0})},deletePiutang(e){this.ready=!1,c.delete(`https://backend.keuanganfpti.com/api/delete-piutang/${e}`,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(o=>{console.log(o.data),this.showAlert("Request Success","Piutang berhasil dihapus","success"),this.fetchDataPiutang()}).catch(o=>{this.showAlert("Request Failed","Piutang gagal dihapus","error"),console.error(o),this.ready=!0})},async fetchDataPiutang(){try{const e=await c.get("https://backend.keuanganfpti.com/api/list-piutang",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.piutangs=e.data.data,this.ready=!0}catch(e){this.ready=!0,console.error(e)}},async fetchDataActiveEvent(){try{const e=await c.get("https://backend.keuanganfpti.com/api/event-active",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.events=e.data.data}catch(e){console.error(e)}},showAlert(e,o,i){this.$swal({title:e,text:o,icon:i}).then(()=>{$("#addPiutang").modal("hide"),$("#aditPiutang").modal("hide")})},konfirmasi(e,o){N.fire({title:"Konfirmasi Penghapusan",text:`Apakah Anda yakin ingin menghapus piutang ${o}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#061387",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(i=>{i.isConfirmed&&this.deletePiutang(e)})}},computed:{formatCurrency:function(){return function(e){return e?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e):"Rp 0,00"}}},created(){const e=sessionStorage.getItem("token");if(e)try{const[o,i]=e.split("."),m=JSON.parse(atob(o)),s=atob(i),n=JSON.parse(atob(e.split(".")[1])),t=n.exp,h=new Date(t*1e3);console.log("Waktu Kedaluwarsa (UTC):",h.toUTCString()),new Date>h?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const _=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),_!=="1"?this.$router.push("/unauthorized"):(!m||!s)&&this.$router.push("/"),this.fetchDataPiutang(),this.fetchDataActiveEvent()}catch(o){console.error("Error decoding token:",o),this.$router.push("/")}else this.$router.push("/")}},Oa=Object.assign(Ra,{__name:"Piutang",setup(e){const o=k(!1),i=k(""),m=()=>{o.value=!o.value,i.value=o.value?"toggle-sidebar":""};return(s,n)=>(r(),u(g,null,[a("div",T,[f(B,{class:y(i.value)},null,8,["class"]),a("div",E,[a("div",I,[f(C,{onToggleSidebar:m}),a("div",F,[H,a("div",J,[R,a("div",q,[z,a("div",L,[s.ready?v("",!0):(r(),u("p",K,"Loading...")),s.ready?(r(),U(D(j),{key:1,class:"display table table-striped"},{default:w(()=>[M,a("tbody",null,[(r(!0),u(g,null,b(s.piutangs,(t,h)=>(r(),u("tr",{key:t.id},[a("td",null,d(h+1),1),a("td",null,[a("div",O,[a("div",G,[a("button",{type:"button",class:"btn btn-warning","data-toggle":"modal","data-target":"#aditPiutang",onClick:_=>s.setDataUpdate(t.pihak_peminjam,t.no_hp,t.jumlah_pinjaman,t.deskripsi_pinjaman,t.id)},X,8,W)]),a("div",Y,[a("button",{onClick:_=>s.konfirmasi(t.id,t.pihak_peminjam),class:"btn btn-danger customDetail"},aa,8,Z)])])]),a("td",null,d(t.pihak_peminjam),1),a("td",null,d(t.no_hp),1),a("td",null,d(t.jumlah_pinjaman),1),a("td",null,d(t.deskripsi_pinjaman),1),a("td",null,d(t.status),1)]))),128))])]),_:1})):v("",!0)])]),ta])])]),f(A)])]),a("div",ea,[a("div",sa,[a("div",na,[oa,a("div",ia,[a("form",null,[a("div",la,[da,l(a("input",{type:"text",class:"form-control",id:"piJam",placeholder:"masukkan pihak peminjam","onUpdate:modelValue":n[0]||(n[0]=t=>s.formPiutang.pihak_peminjam=t)},null,512),[[p,s.formPiutang.pihak_peminjam]])]),a("div",ra,[ua,l(a("input",{type:"number",class:"form-control",id:"noHp",placeholder:"masukkan nomor hp","onUpdate:modelValue":n[1]||(n[1]=t=>s.formPiutang.no_hp=t)},null,512),[[p,s.formPiutang.no_hp]])]),a("div",pa,[ma,l(a("input",{type:"number",class:"form-control",id:"jumpin",placeholder:"masukkan jumlah pinjaman","onUpdate:modelValue":n[2]||(n[2]=t=>s.formPiutang.jumlah_pinjaman=t)},null,512),[[p,s.formPiutang.jumlah_pinjaman]])]),a("div",ca,[ha,l(a("select",{class:"form-select","onUpdate:modelValue":n[3]||(n[3]=t=>s.selectedEvent=t)},[ga,(r(!0),u(g,null,b(s.events,t=>(r(),u("option",{key:t.id,value:t.id},d(t.nama_event)+" - "+d(t.tanggal_event),9,_a))),128))],512),[[P,s.selectedEvent]])]),a("div",fa,[ba,l(a("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan deskripsi","onUpdate:modelValue":n[4]||(n[4]=t=>s.formPiutang.deskripsi_pinjaman=t)},null,512),[[p,s.formPiutang.deskripsi_pinjaman]])])])]),a("div",ka,[va,a("button",{type:"button",class:"btn blueButton",onClick:n[5]||(n[5]=(...t)=>s.createPiutang&&s.createPiutang(...t))}," Simpan ")])])])]),a("div",Pa,[a("div",ja,[a("div",ya,[Ua,a("div",wa,[a("form",null,[a("div",Da,[Sa,l(a("input",{type:"text",class:"form-control",id:"piJam",placeholder:"masukkan pihak peminjam","onUpdate:modelValue":n[6]||(n[6]=t=>s.formUpdatePiutang.pihak_peminjam=t)},null,512),[[p,s.formUpdatePiutang.pihak_peminjam]])]),a("div",Ba,[Ca,l(a("input",{type:"number",class:"form-control",id:"noHp",placeholder:"masukkan nomor hp","onUpdate:modelValue":n[7]||(n[7]=t=>s.formUpdatePiutang.no_hp=t)},null,512),[[p,s.formUpdatePiutang.no_hp]])]),a("div",Aa,[Va,l(a("input",{type:"number",class:"form-control",id:"jumpin",placeholder:"masukkan jumlah pinjaman","onUpdate:modelValue":n[8]||(n[8]=t=>s.formUpdatePiutang.jumlah_pinjaman=t)},null,512),[[p,s.formUpdatePiutang.jumlah_pinjaman]])]),a("div",Na,[$a,l(a("select",{class:"form-select","onUpdate:modelValue":n[9]||(n[9]=t=>s.selectedEvent=t)},[Ta,(r(!0),u(g,null,b(s.events,t=>(r(),u("option",{key:t.id,value:t.id},d(t.nama_event)+" - "+d(t.tanggal_event),9,Ea))),128))],512),[[P,s.selectedEvent]])]),a("div",Ia,[Fa,l(a("textarea",{class:"form-control",id:"keterangan",placeholder:"Masukkan deskripsi","onUpdate:modelValue":n[10]||(n[10]=t=>s.formUpdatePiutang.deskripsi_pinjaman=t)},null,512),[[p,s.formUpdatePiutang.deskripsi_pinjaman]])])])]),a("div",Ha,[Ja,a("button",{type:"button",class:"btn blueButton",onClick:n[11]||(n[11]=(...t)=>s.updatePiutang&&s.updatePiutang(...t))}," Simpan ")])])])])],64))}});export{Oa as default};
