import{S as f}from"./Sidebar-4be0254e.js";import"./TimeVote-777b105b.js";import{N as b,F as y}from"./Footer-f46338e3.js";import{a as p}from"./sweetalert2.all-1e3fb24f.js";import{P as k,D as v}from"./jquery.dataTables-e7634350.js";import{r as h,b as o,f as d,i as m,n as P,g as e,l as _,c as w,z as D,A as S,F as x,B as C,C as n}from"./index-63600712.js";const N={id:"wrapper"},B={id:"content-wrapper",class:"d-flex flex-column"},I={id:"content"},T={class:"container-fluid mt-4"},F=e("h1",{class:"h3 mb-0 text-gray-800 text-center mb-5"}," List Dana Internal ",-1),j={class:"row"},A=e("div",{class:"col-1"},null,-1),z={class:"col-10"},V=e("div",{class:"row mb-3"},[e("div",{class:"col-6"}),e("div",{class:"col-6"})],-1),$={class:"table-responsive"},R={key:0,class:"text-center"},K=e("thead",null,[e("tr",null,[e("th",{scope:"col",style:{width:"50px"}},"No"),e("th",{scope:"col"},"Nominal"),e("th",{scope:"col"},"Keterangan"),e("th",{scope:"col"},"Tanggal Masuk"),e("th",{scope:"col"},"Pengirim")])],-1),L=e("div",{class:"col-1"},null,-1);k.use(v);const O={data(){return{pemasukan:[],formPemasukan:{pemberi_dana:"",jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",id_penerima:""},ready:!1,user_id:""}},methods:{createPemasukan(){this.ready=!1;const a=new FormData;a.append("pemberi_dana",this.formPemasukan.pemberi_dana),a.append("jumlah_transaksi",this.formPemasukan.jumlah_transaksi),a.append("deskripsi",this.formPemasukan.deskripsi),a.append("tgl_transaksi",this.formPemasukan.tgl_transaksi),a.append("id_penerima",1),p.post("https://backend.keuanganfpti.com/api/external-transaksi",a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.formPemasukan={pemberi_dana:"",jumlah_transaksi:"",deskripsi:"",tgl_transaksi:"",id_penerima:""},this.showAlert("Request Success","Pemasukan berhasil buat","success"),this.fetchDataPemasukan()}).catch(s=>{this.showAlert("Request Failed","Pemasukan gagal buat","error"),console.error(s),this.ready=!0})},async fetchDataPemasukan(){try{const a=await p.get("https://backend.keuanganfpti.com/api/list-pemasukan/2",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.pemasukan=a.data.data,this.ready=!0}catch(a){this.ready=!0,console.error(a)}}},computed:{formatCurrency:function(){return function(a){return a?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a):"Rp 0,00"}}},created(){const a=sessionStorage.getItem("token");if(a)try{const[s,i]=a.split("."),u=JSON.parse(atob(s)),r=atob(i),l=JSON.parse(atob(a.split(".")[1])),t=l.exp,c=new Date(t*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const g=l.level;this.user_id=l.id,console.log("ini idddd:",this.user_id),g!=="1"?this.$router.push("/unauthorized"):(!u||!r)&&this.$router.push("/"),this.fetchDataPemasukan()}catch(s){console.error("Error decoding token:",s),this.$router.push("/")}else this.$router.push("/")}},G=Object.assign(O,{__name:"Pemasukan",setup(a){const s=h(!1),i=h(""),u=()=>{s.value=!s.value,i.value=s.value?"toggle-sidebar":""};return(r,l)=>(o(),d("div",N,[m(f,{class:P(i.value)},null,8,["class"]),e("div",B,[e("div",I,[m(b,{onToggleSidebar:u}),e("div",T,[F,e("div",j,[A,e("div",z,[V,e("div",$,[r.ready?_("",!0):(o(),d("p",R,"Loading...")),r.ready?(o(),w(S(k),{key:1,class:"display table table-striped"},{default:D(()=>[K,e("tbody",null,[(o(!0),d(x,null,C(r.pemasukan,(t,c)=>(o(),d("tr",{key:t.id},[e("td",null,n(c+1),1),e("td",null,n(r.formatCurrency(t.jumlah_transaksi)),1),e("td",null,n(t.deskripsi),1),e("td",null,n(t.tgl_transaksi),1),e("td",null,n(t.nama_pengirim),1)]))),128))])]),_:1})):_("",!0)])]),L])])]),m(y)])]))}});export{G as default};
